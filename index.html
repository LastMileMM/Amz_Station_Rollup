<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Last Mile Service Performance Report</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
:root{--bg:#f8f9fc;--sf:#ffffff;--sf2:#f1f3f8;--bd:#e2e6ef;--ac:#4f5fed;--ac2:#7c6cff;--gn:#16a34a;--gnb:rgba(22,163,74,.08);--yl:#ca8a04;--ylb:rgba(202,138,4,.08);--rd:#dc2626;--rdb:rgba(220,38,38,.08);--or:#ea580c;--orb:rgba(234,88,12,.08);--cy:#0891b2;--cyb:rgba(8,145,178,.08);--tx:#1e293b;--mu:#64748b;--dm:#94a3b8;--fn:'DM Sans',sans-serif;--mo:'JetBrains Mono',monospace}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:var(--fn);background:var(--bg);color:var(--tx);min-height:100vh;-webkit-font-smoothing:antialiased}
::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:#ccc;border-radius:3px}
.app{max-width:1440px;margin:0 auto;padding:28px 32px}

.hdr{display:flex;align-items:flex-end;justify-content:space-between;margin-bottom:28px;padding-bottom:22px;border-bottom:2px solid var(--bd)}
.hdr h1{font-size:22px;font-weight:700;letter-spacing:-.02em;color:var(--ac)}
.hdr .sub{color:var(--mu);font-size:12.5px;margin-top:4px}
.hdr .stamp{font-family:var(--mo);font-size:10px;color:var(--dm);background:var(--sf2);padding:5px 12px;border-radius:6px;border:1px solid var(--bd)}

.tabs{display:flex;gap:4px;margin-bottom:26px;overflow-x:auto;padding-bottom:3px}
.tabs button{padding:9px 18px;border-radius:8px;border:1px solid transparent;background:transparent;color:var(--mu);font-family:var(--fn);font-size:12px;font-weight:600;cursor:pointer;transition:all .15s;white-space:nowrap}
.tabs button:hover{color:var(--tx);background:var(--sf);border-color:var(--bd)}
.tabs button.on{background:var(--ac);color:#fff;border-color:var(--ac)}

.kg{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-bottom:22px}
@media(max-width:1100px){.kg{grid-template-columns:repeat(2,1fr)}}@media(max-width:600px){.kg{grid-template-columns:1fr}}
.kp{background:var(--sf);border:1px solid var(--bd);border-radius:12px;padding:18px 20px;position:relative;overflow:hidden;box-shadow:0 1px 3px rgba(0,0,0,.04)}
.kp::after{content:'';position:absolute;top:0;left:0;right:0;height:3px;border-radius:12px 12px 0 0}
.kp.gr::after{background:var(--gn)}.kp.ye::after{background:var(--yl)}.kp.re::after{background:var(--rd)}.kp.cy::after{background:var(--cy)}.kp.or::after{background:var(--or)}
.kp .lb{font-size:10px;text-transform:uppercase;letter-spacing:.07em;color:var(--mu);margin-bottom:7px;font-weight:600}
.kp .vl{font-family:var(--mo);font-size:26px;font-weight:700;line-height:1}
.kp .vl.gr{color:var(--gn)}.kp .vl.ye{color:var(--yl)}.kp .vl.re{color:var(--rd)}.kp .vl.or{color:var(--or)}.kp .vl.cy{color:var(--cy)}
.kp .sb{font-size:10px;color:var(--dm);margin-top:6px}
.delta{font-size:10px;font-family:var(--mo);font-weight:600;margin-left:4px}
.delta.up{color:var(--gn)}.delta.dn{color:var(--rd)}.delta.nt{color:var(--dm)}

.sc{font-size:14px;font-weight:700;margin:22px 0 14px;color:var(--tx);display:flex;align-items:center;gap:8px;letter-spacing:-.01em}
.sc::before{content:'';width:4px;height:16px;border-radius:2px}
.sc.perf::before{background:var(--ac)}.sc.sent::before{background:var(--cy)}.sc.mom::before{background:var(--or)}.sc.det::before{background:var(--gn)}

.tw{background:var(--sf);border:1px solid var(--bd);border-radius:12px;overflow:hidden;margin-bottom:18px;box-shadow:0 1px 3px rgba(0,0,0,.03)}
.tw.scr{overflow-x:auto}
table{width:100%;border-collapse:collapse;font-size:12.5px}
th{padding:10px 16px;text-align:left;font-weight:600;color:var(--mu);text-transform:uppercase;font-size:9.5px;letter-spacing:.06em;border-bottom:1px solid var(--bd);background:var(--sf2);white-space:nowrap}
td{padding:9px 16px;border-bottom:1px solid var(--bd)}
tr:last-child td{border-bottom:none}tr:hover{background:rgba(79,95,237,.02)}
td strong{font-weight:600;color:var(--tx)}

.bg{display:inline-block;padding:3px 10px;border-radius:20px;font-size:10px;font-weight:700;font-family:var(--mo);letter-spacing:.02em}
.bg.gr{background:var(--gnb);color:var(--gn)}.bg.ye{background:var(--ylb);color:var(--yl)}.bg.re{background:var(--rdb);color:var(--rd)}.bg.or{background:var(--orb);color:var(--or)}.bg.cy{background:var(--cyb);color:var(--cy)}

.bars{margin-bottom:22px}
.br{display:flex;align-items:center;gap:10px;margin-bottom:7px}
.br .bl{width:100px;font-size:11px;color:var(--mu);text-align:right;flex-shrink:0;font-weight:500}
.br .bt{flex:1;height:22px;background:var(--sf2);border-radius:5px;overflow:hidden;border:1px solid var(--bd)}
.br .bf{height:100%;border-radius:4px;display:flex;align-items:center;padding-left:8px;font-size:10px;font-weight:700;color:#fff;font-family:var(--mo);min-width:32px;transition:width .5s ease}
.bf.gr{background:linear-gradient(90deg,#15803d,var(--gn))}.bf.ye{background:linear-gradient(90deg,#a16207,var(--yl))}.bf.re{background:linear-gradient(90deg,#b91c1c,var(--rd))}.bf.bl{background:linear-gradient(90deg,#3730a3,var(--ac))}.bf.cy{background:linear-gradient(90deg,#0e7490,var(--cy))}
.br .bc{width:40px;font-size:11px;color:var(--dm);font-family:var(--mo);font-weight:500}

.duo{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:18px}
@media(max-width:800px){.duo{grid-template-columns:1fr}}

/* Sentiment */
.sent-box{background:linear-gradient(135deg,rgba(8,145,178,.04),rgba(79,95,237,.04));border:1px solid rgba(8,145,178,.18);border-radius:14px;padding:22px;margin-bottom:22px}
.sent-box .sent-title{font-size:15px;font-weight:700;margin-bottom:16px;display:flex;align-items:center;gap:8px;color:var(--cy)}
.sent-kpis{display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:12px;margin-bottom:16px}
.sent-kpi{background:var(--sf);border:1px solid var(--bd);border-radius:10px;padding:14px;text-align:center;box-shadow:0 1px 2px rgba(0,0,0,.03)}
.sent-kpi .sk-lb{font-size:9px;text-transform:uppercase;letter-spacing:.06em;color:var(--mu);margin-bottom:5px}
.sent-kpi .sk-vl{font-family:var(--mo);font-size:22px;font-weight:700}
.adopt-bar{display:flex;align-items:center;gap:10px;margin-bottom:12px}
.adopt-bar .ab-lbl{font-size:11px;color:var(--mu);min-width:70px}
.adopt-bar .ab-track{flex:1;height:20px;background:var(--sf2);border-radius:5px;overflow:hidden;position:relative;border:1px solid var(--bd)}
.adopt-bar .ab-fill{height:100%;border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:9.5px;font-weight:700;color:#fff;font-family:var(--mo)}
.adopt-bar .ab-target{position:absolute;top:0;bottom:0;width:2px;background:var(--yl);left:85%}
.adopt-bar .ab-val{font-family:var(--mo);font-size:12px;font-weight:600;min-width:48px;text-align:right}
.fb-card{background:var(--sf);border:1px solid var(--bd);border-radius:10px;padding:16px;margin-bottom:10px;box-shadow:0 1px 2px rgba(0,0,0,.03)}
.fb-hdr{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;flex-wrap:wrap;gap:6px}
.fb-dsp{font-family:var(--mo);font-weight:600;font-size:12px}
.fb-date{font-size:10px;color:var(--dm)}
.fb-scores{display:flex;gap:10px;font-family:var(--mo);font-size:10px;color:var(--mu)}
.fb-scores span{display:flex;align-items:center;gap:3px}
.fb-txt{font-size:11.5px;color:var(--mu);line-height:1.5;font-style:italic;padding:8px 0 0;border-top:1px solid var(--bd);margin-top:6px}
.fb-txt.issue{border-left:2px solid var(--rd);padding-left:10px;margin-bottom:6px;border-top:none;padding-top:0}
.fb-txt.pos{border-left:2px solid var(--gn);padding-left:10px;border-top:none;padding-top:0}
.no-data{text-align:center;padding:22px;color:var(--dm);font-size:12px;font-style:italic}

/* MoM */
.mom-box{background:linear-gradient(135deg,rgba(234,88,12,.04),rgba(202,138,4,.04));border:1px solid rgba(234,88,12,.18);border-radius:14px;padding:22px;margin-bottom:22px}
.mom-box .mom-title{font-size:15px;font-weight:700;margin-bottom:16px;display:flex;align-items:center;gap:8px;color:var(--or)}
.chart-row{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:16px}
@media(max-width:900px){.chart-row{grid-template-columns:1fr}}
.chart-card{background:var(--sf);border:1px solid var(--bd);border-radius:10px;padding:18px;box-shadow:0 1px 2px rgba(0,0,0,.03)}
.chart-card .cc-title{font-size:11px;font-weight:600;color:var(--mu);text-transform:uppercase;letter-spacing:.05em;margin-bottom:14px}
.chart-card canvas{width:100%!important;height:210px!important}
</style>
</head>
<body>
<div id="root"></div>
<script>
var WO={"overall":{"label":"OVERALL","total":2258,"completed":1920,"cancelled":232,"on_hold":7,"open":99,"status_counts":{"COMPLETED":1920,"CANCELLED":232,"DISPATCH_ACCEPTED":59,"ASSIGNED":27,"AWAITING_ESTIMATE_APPROVAL":7,"ON_HOLD":7,"DISPATCHED":3,"IN_REPAIR":1,"PENDING":1,"APPROVED_ESTIMATE":1},"priorities":{"MEDIUM":2161,"CRITICAL":51,"LOW":45,"HIGH":1},"categories":{"PREVENTATIVE_MAINTENANCE":852,"MECHANICAL":271,"ELECTRICAL":62,"BODYWORK":41,"STRUCTURAL":1},"types":{"NON_SCHEDULED":2216,"SCHEDULED":42},"workflows":{"CHECK_AND_ADVISE":1146,"REPAIR":356,"PM_A":342,"PM_B":218,"DOT":131,"PM_DOT":14,"DOT_INSPECTION":12,"CTC":11,"AIR_FILTER":3,"BRAKE_SYSTEM_FLUSH":2,"DPFE_SENSOR":1,"OIL_CHANGE":1,"FILTER_CRANKCASE_VENTILATION":1,"COOLANT_SERVICES":1,"SERPENTINE_BELT":1,"LIFT_GATE_PM":1},"technicians":{"LM - Jose Madrigal":190,"LM - Terence Lucas":176,"LM - Jett Bukovac":167,"LM - Thomas McRoberts":163,"LM - Evereth Salas":159,"LM - Hector Brito":116,"LM - Justin Forte":113,"LM - Marcos Tun":109,"LM - Alejandro Fernandez":88,"LM - Victor Wells":84,"FM - Eugene Fowler":79,"LM - Brooks Lawson":71,"LM - Lamont Henderson":65,"LM - Fernando Cruz":53,"LM - Timothy Merritt":45},"avg_cost":727.89,"total_cost":743898.58,"cost_count":1022,"avg_labor":0,"avg_parts":0,"median_comp_hrs":34.3,"avg_comp_hrs":72.3,"comp_time_count":1920,"median_resp_hrs":9.2,"resp_count":948,"hold_reasons":{"Additional Work Needed":16,"Parts Sourcing Delay":4,"Waiting for Diagnosis":4,"Unable to access unit":3,"Part delay: back ordered":2,"Part delay: waiting for delivery":2,"Waiting on customer: parts to be supplied":1},"cancel_reasons":{"Duplicate":106,"Work no longer required":74,"IT Issue":17,"Unit at dealer":12,"Unit no longer on site":12,"Unit at third party workshop":4,"Unable to source parts":3,"Unable to source tools":2}},"stations":{"HAU1":{"label":"HAU1","total":128,"completed":113,"cancelled":14,"on_hold":0,"open":1,"status_counts":{"COMPLETED":113,"CANCELLED":14,"AWAITING_ESTIMATE_APPROVAL":1},"priorities":{"MEDIUM":126,"LOW":2},"categories":{"PREVENTATIVE_MAINTENANCE":76,"MECHANICAL":20,"BODYWORK":7,"ELECTRICAL":7},"types":{"NON_SCHEDULED":126,"SCHEDULED":2},"workflows":{"CHECK_AND_ADVISE":49,"PM_A":34,"REPAIR":23,"PM_B":13,"DOT":3,"PM_DOT":1,"DPFE_SENSOR":1,"FILTER_CRANKCASE_VENTILATION":1,"COOLANT_SERVICES":1,"AIR_FILTER":1},"technicians":{"LM - Brooks Lawson":71,"LM - Fernando Cruz":52,"LM - Kelsey Githens":2,"Last Mile - Brooks Lawson":1,"Tech - Kelsey Githens":1},"avg_cost":740.44,"total_cost":44426.16,"cost_count":60,"avg_labor":0,"avg_parts":0,"median_comp_hrs":19.1,"avg_comp_hrs":53.9,"comp_time_count":113,"median_resp_hrs":3.2,"resp_count":78,"hold_reasons":{},"cancel_reasons":{"Duplicate":6,"Work no longer required":4,"Unit no longer on site":2,"Unit at third party workshop":1,"IT Issue":1}},"HCL2":{"label":"HCL2","total":144,"completed":94,"cancelled":16,"on_hold":1,"open":33,"status_counts":{"COMPLETED":94,"DISPATCH_ACCEPTED":28,"CANCELLED":16,"AWAITING_ESTIMATE_APPROVAL":5,"ON_HOLD":1},"priorities":{"MEDIUM":143,"LOW":1},"categories":{"PREVENTATIVE_MAINTENANCE":115,"MECHANICAL":24,"ELECTRICAL":3,"BODYWORK":2},"types":{"NON_SCHEDULED":140,"SCHEDULED":4},"workflows":{"REPAIR":32,"CHECK_AND_ADVISE":30,"PM_A":27,"PM_B":22,"DOT":22,"PM_DOT":5,"DOT_INSPECTION":4,"LIFT_GATE_PM":1},"technicians":{"LM NC - Justin Owens":40,"Macon, GA - Justin Owens":31,"Tech - Kelsey Githens":22,"FM - Eugene Fowler":16,"LM - Victor Wells":6,"LM - Eugene Fowler":4,"LM - Alexander Childs":4,"NC - Steven Knotts":3,"LM - Christopher Steele":2},"avg_cost":934.35,"total_cost":46717.59,"cost_count":50,"avg_labor":0,"avg_parts":0,"median_comp_hrs":87.4,"avg_comp_hrs":112.1,"comp_time_count":94,"median_resp_hrs":19.8,"resp_count":23,"hold_reasons":{"Waiting for Diagnosis":1,"Part delay: back ordered":1},"cancel_reasons":{"Work no longer required":8,"Duplicate":7,"IT Issue":1}},"HCT2":{"label":"HCT2","total":78,"completed":72,"cancelled":6,"on_hold":0,"open":0,"status_counts":{"COMPLETED":72,"CANCELLED":6},"priorities":{"MEDIUM":77,"LOW":1},"categories":{"PREVENTATIVE_MAINTENANCE":37,"MECHANICAL":7,"BODYWORK":1},"types":{"NON_SCHEDULED":78},"workflows":{"CHECK_AND_ADVISE":38,"REPAIR":14,"PM_B":13,"PM_A":9,"DOT":4},"technicians":{"LM - Alexander Childs":39,"LM - Cletus Harvey":18,"FM - Eugene Fowler":16,"LM - Eugene Fowler":3},"avg_cost":953.93,"total_cost":35295.5,"cost_count":37,"avg_labor":0,"avg_parts":0,"median_comp_hrs":44.3,"avg_comp_hrs":65.7,"comp_time_count":72,"median_resp_hrs":14.1,"resp_count":42,"hold_reasons":{"Additional Work Needed":1},"cancel_reasons":{"Unit at third party workshop":2,"Unable to duplicate issue":2,"Work no longer required":1,"Duplicate":1}},"HDT3":{"label":"HDT3","total":363,"completed":316,"cancelled":29,"on_hold":0,"open":18,"status_counts":{"COMPLETED":316,"CANCELLED":29,"DISPATCH_ACCEPTED":12,"ASSIGNED":6},"priorities":{"MEDIUM":309,"CRITICAL":51,"LOW":2,"HIGH":1},"categories":{"PREVENTATIVE_MAINTENANCE":59,"MECHANICAL":13,"BODYWORK":2,"ELECTRICAL":1},"types":{"NON_SCHEDULED":356,"SCHEDULED":7},"workflows":{"CHECK_AND_ADVISE":245,"PM_A":45,"REPAIR":40,"PM_B":14,"DOT":14,"PM_DOT":2},"technicians":{"LM - Terence Lucas":176,"LM - Thomas McRoberts":162,"IN - David Ross (Lead Tech)":6,"Last Mile - Thomas McRoberts":5,"LM - Richard Anderson Sr.":5,"LM - Victor Wells":5,"Last Mile - Terence Lucas":3,"Last Mile - Richard Anderson Sr.":1},"avg_cost":779.41,"total_cost":168353.33,"cost_count":216,"avg_labor":0,"avg_parts":0,"median_comp_hrs":42.1,"avg_comp_hrs":68.6,"comp_time_count":316,"median_resp_hrs":13.1,"resp_count":164,"hold_reasons":{"Part delay: waiting for delivery":1},"cancel_reasons":{"Duplicate":14,"Work no longer required":7,"Unit at dealer":4,"Unit no longer on site":2,"Unit at third party workshop":1,"IT Issue":1}},"HDY1":{"label":"HDY1","total":102,"completed":90,"cancelled":10,"on_hold":0,"open":2,"status_counts":{"COMPLETED":90,"CANCELLED":10,"PENDING":1,"ASSIGNED":1},"priorities":{"MEDIUM":100,"LOW":2},"categories":{"PREVENTATIVE_MAINTENANCE":66,"MECHANICAL":34,"ELECTRICAL":1},"types":{"NON_SCHEDULED":101,"SCHEDULED":1},"workflows":{"PM_A":32,"CHECK_AND_ADVISE":29,"REPAIR":18,"PM_B":12,"DOT":6,"PM_DOT":3,"AIR_FILTER":2},"technicians":{"LM - Timothy Merritt":45,"LM - Victor Wells":22,"OH - Charles Burgess":13,"LM - Richard Anderson Sr.":6,"FM - Eugene Fowler":5,"CORE - Robert Sutton":4,"Last Mile - Victor Wells":2,"OH - Randy Fisher":2,"LM - Fernando Cruz":1},"avg_cost":934.31,"total_cost":27095.07,"cost_count":29,"avg_labor":0,"avg_parts":0,"median_comp_hrs":51.0,"avg_comp_hrs":88.3,"comp_time_count":90,"median_resp_hrs":6.9,"resp_count":32,"hold_reasons":{"Additional Work Needed":2,"Waiting for Diagnosis":1},"cancel_reasons":{"Duplicate":5,"Work no longer required":4,"Unit no longer on site":1}},"HHO3":{"label":"HHO3","total":266,"completed":225,"cancelled":30,"on_hold":3,"open":8,"status_counts":{"COMPLETED":225,"CANCELLED":30,"DISPATCH_ACCEPTED":4,"ASSIGNED":4,"ON_HOLD":3},"priorities":{"MEDIUM":258,"LOW":8},"categories":{"PREVENTATIVE_MAINTENANCE":47,"MECHANICAL":8,"BODYWORK":2,"ELECTRICAL":1},"types":{"NON_SCHEDULED":258,"SCHEDULED":8},"workflows":{"CHECK_AND_ADVISE":153,"REPAIR":33,"PM_B":29,"DOT":21,"PM_A":19,"DOT_INSPECTION":8,"PM_DOT":1},"technicians":{"LM - Evereth Salas":159,"LM - Lamont Henderson":65,"LM - Sabrina Finch":38,"CORE - Manuel Hidalgo":1},"avg_cost":609.12,"total_cost":81012.57,"cost_count":133,"avg_labor":0,"avg_parts":0,"median_comp_hrs":31.6,"avg_comp_hrs":76.2,"comp_time_count":225,"median_resp_hrs":7.1,"resp_count":107,"hold_reasons":{"Additional Work Needed":4,"Unable to access unit":1,"Part delay: waiting for delivery":1},"cancel_reasons":{"Duplicate":16,"Work no longer required":8,"IT Issue":6,"Unable to source tools":1}},"HIN3":{"label":"HIN3","total":67,"completed":50,"cancelled":14,"on_hold":0,"open":3,"status_counts":{"COMPLETED":50,"CANCELLED":14,"DISPATCHED":3},"priorities":{"MEDIUM":66,"LOW":1},"categories":{"PREVENTATIVE_MAINTENANCE":20,"MECHANICAL":5,"ELECTRICAL":1,"BODYWORK":1},"types":{"NON_SCHEDULED":65,"SCHEDULED":2},"workflows":{"CHECK_AND_ADVISE":37,"REPAIR":9,"PM_A":8,"PM_B":8,"DOT":5},"technicians":{"LM - Victor Wells":51,"Last Mile - John Weaver":11,"IN - David Ross (Lead Tech)":2,"Last Mile - Victor Wells":1,"LM - Thomas McRoberts":1},"avg_cost":749.46,"total_cost":24732.07,"cost_count":33,"avg_labor":0,"avg_parts":0,"median_comp_hrs":23.9,"avg_comp_hrs":63.9,"comp_time_count":50,"median_resp_hrs":7.0,"resp_count":27,"hold_reasons":{"Part delay: back ordered":1},"cancel_reasons":{"Work no longer required":7,"Duplicate":5,"IT Issue":1,"Unit at dealer":1}},"HLA2":{"label":"HLA2","total":374,"completed":322,"cancelled":33,"on_hold":1,"open":18,"status_counts":{"COMPLETED":322,"CANCELLED":33,"DISPATCH_ACCEPTED":12,"ASSIGNED":4,"ON_HOLD":1,"AWAITING_ESTIMATE_APPROVAL":1,"APPROVED_ESTIMATE":1},"priorities":{"MEDIUM":362,"LOW":12},"categories":{"PREVENTATIVE_MAINTENANCE":174,"MECHANICAL":75,"ELECTRICAL":16,"BODYWORK":13,"STRUCTURAL":1},"types":{"NON_SCHEDULED":360,"SCHEDULED":14},"workflows":{"CHECK_AND_ADVISE":172,"PM_A":73,"REPAIR":66,"PM_B":37,"CTC":11,"DOT":9},"technicians":{"LM - Jose Madrigal":188,"LM - Justin Forte":113,"Fresno - Nicholas Darter":18,"LM - Denzel Alexander":15,"Fresno - David Knight":11,"LM - Dale Garcia":9,"Enrique Gomez-Navarro":6,"Marcos Valdivia":6,"Fresno - Pablo Alvarenga \ud83d\udcbb":4,"LM - Kelsey Githens":1},"avg_cost":691.05,"total_cost":91910.2,"cost_count":133,"avg_labor":0,"avg_parts":0,"median_comp_hrs":23.7,"avg_comp_hrs":67.4,"comp_time_count":322,"median_resp_hrs":10.9,"resp_count":145,"hold_reasons":{"Additional Work Needed":2,"Parts Sourcing Delay":1},"cancel_reasons":{"Duplicate":24,"Work no longer required":9}},"HMK4":{"label":"HMK4","total":115,"completed":102,"cancelled":7,"on_hold":1,"open":5,"status_counts":{"COMPLETED":102,"CANCELLED":7,"ASSIGNED":5,"ON_HOLD":1},"priorities":{"MEDIUM":115},"categories":{"PREVENTATIVE_MAINTENANCE":70,"MECHANICAL":22,"ELECTRICAL":19,"BODYWORK":3},"types":{"NON_SCHEDULED":114,"SCHEDULED":1},"workflows":{"PM_A":31,"REPAIR":27,"CHECK_AND_ADVISE":19,"PM_B":18,"DOT":17,"BRAKE_SYSTEM_FLUSH":2,"SERPENTINE_BELT":1},"technicians":{"LM - Alejandro Fernandez":84,"LM - William Low":29},"avg_cost":565.24,"total_cost":22609.56,"cost_count":40,"avg_labor":0,"avg_parts":0,"median_comp_hrs":20.3,"avg_comp_hrs":47.8,"comp_time_count":102,"median_resp_hrs":13.6,"resp_count":57,"hold_reasons":{"Additional Work Needed":2,"Waiting for Diagnosis":1},"cancel_reasons":{"Duplicate":6,"Work no longer required":1}},"HMS2":{"label":"HMS2","total":152,"completed":139,"cancelled":9,"on_hold":0,"open":4,"status_counts":{"COMPLETED":139,"CANCELLED":9,"ASSIGNED":4},"priorities":{"MEDIUM":151,"LOW":1},"categories":{"PREVENTATIVE_MAINTENANCE":58,"MECHANICAL":10},"types":{"NON_SCHEDULED":151,"SCHEDULED":1},"workflows":{"CHECK_AND_ADVISE":76,"REPAIR":29,"PM_B":23,"PM_A":15,"DOT":7,"PM_DOT":2},"technicians":{"Last Mile - Joseph Defreeuw":43,"FM - Eugene Fowler":42,"LM - Michael Gorman":22,"Last Mile - Brad Butti":17,"MN - Patrick Roberts (MSP7)":9,"LM - Kelsey Githens":5,"LM - Richard Anderson Sr.":4,"LM - Alejandro Fernandez":4,"LM - Eugene Fowler":2,"MN - Daniel Freeman (MSP8/MSP1 Mon,Tue/All PM-B)":1},"avg_cost":588.94,"total_cost":48292.77,"cost_count":82,"avg_labor":0,"avg_parts":0,"median_comp_hrs":30.4,"avg_comp_hrs":58.3,"comp_time_count":139,"median_resp_hrs":8.7,"resp_count":67,"hold_reasons":{"Parts Sourcing Delay":1,"Additional Work Needed":1},"cancel_reasons":{"Duplicate":5,"Work no longer required":4}},"HPD1":{"label":"HPD1","total":13,"completed":8,"cancelled":5,"on_hold":0,"open":0,"status_counts":{"COMPLETED":8,"CANCELLED":5},"priorities":{"MEDIUM":13},"categories":{"MECHANICAL":3,"BODYWORK":1,"PREVENTATIVE_MAINTENANCE":1},"types":{"NON_SCHEDULED":13},"workflows":{"CHECK_AND_ADVISE":10,"PM_B":1,"REPAIR":1,"DOT":1},"technicians":{"Last Mile - Noussayr Marzouki":5,"CORE - Michael Ward":5},"avg_cost":691.02,"total_cost":1382.04,"cost_count":2,"avg_labor":0,"avg_parts":0,"median_comp_hrs":62.0,"avg_comp_hrs":69.0,"comp_time_count":8,"median_resp_hrs":12.6,"resp_count":7,"hold_reasons":{},"cancel_reasons":{"Work no longer required":2,"Completed in legacy platform":1,"IT Issue":1,"Duplicate":1}},"HSD2":{"label":"HSD2","total":10,"completed":7,"cancelled":3,"on_hold":0,"open":0,"status_counts":{"COMPLETED":7,"CANCELLED":3},"priorities":{"MEDIUM":10},"categories":{"MECHANICAL":8,"ELECTRICAL":1,"PREVENTATIVE_MAINTENANCE":1},"types":{"NON_SCHEDULED":10},"workflows":{"CHECK_AND_ADVISE":9,"DOT":1},"technicians":{"CORE - Juan Molina":6,"LM - Jose Madrigal":2},"avg_cost":548.01,"total_cost":1644.02,"cost_count":3,"avg_labor":0,"avg_parts":0,"median_comp_hrs":29.7,"avg_comp_hrs":109.2,"comp_time_count":7,"median_resp_hrs":18.1,"resp_count":4,"hold_reasons":{},"cancel_reasons":{"Unit at dealer":1,"Work no longer required":1,"IT Issue":1}},"HSL1":{"label":"HSL1","total":124,"completed":103,"cancelled":18,"on_hold":0,"open":3,"status_counts":{"COMPLETED":103,"CANCELLED":18,"ASSIGNED":3},"priorities":{"MEDIUM":124},"categories":{"PREVENTATIVE_MAINTENANCE":33,"MECHANICAL":8,"BODYWORK":4},"types":{"NON_SCHEDULED":123,"SCHEDULED":1},"workflows":{"CHECK_AND_ADVISE":76,"PM_A":17,"REPAIR":15,"DOT":7,"PM_B":6,"OIL_CHANGE":1},"technicians":{"LM - Marcos Tun":109,"LM - Kelsey Githens":5,"SLC - Dakota Theademan (SLC2)":3,"Last Mile- Marcos Tun":3,"SLC - Torrey Watson ( All sites)":1,"SLC -PM Only Austin Harwood":1},"avg_cost":666.77,"total_cost":29337.68,"cost_count":44,"avg_labor":0,"avg_parts":0,"median_comp_hrs":28.1,"avg_comp_hrs":53.4,"comp_time_count":103,"median_resp_hrs":7.4,"resp_count":73,"hold_reasons":{"Parts Sourcing Delay":1,"Additional Work Needed":1},"cancel_reasons":{"Work no longer required":9,"Duplicate":7,"Unit no longer on site":2}},"HTP2":{"label":"HTP2","total":322,"completed":279,"cancelled":38,"on_hold":1,"open":4,"status_counts":{"COMPLETED":279,"CANCELLED":38,"DISPATCH_ACCEPTED":3,"IN_REPAIR":1,"ON_HOLD":1},"priorities":{"MEDIUM":307,"LOW":15},"categories":{"PREVENTATIVE_MAINTENANCE":95,"MECHANICAL":34,"ELECTRICAL":12,"BODYWORK":5},"types":{"NON_SCHEDULED":321,"SCHEDULED":1},"workflows":{"CHECK_AND_ADVISE":203,"REPAIR":49,"PM_A":32,"PM_B":22,"DOT":14},"technicians":{"LM - Jett Bukovac":167,"LM - Hector Brito":116,"FL - Daniel De Jesus":14,"Last Mile - Hector Brito":9,"LM - Kelsey Githens":7,"Last Mile - Kelsey Githens":3},"avg_cost":756.81,"total_cost":121090.02,"cost_count":160,"avg_labor":0,"avg_parts":0,"median_comp_hrs":51.0,"avg_comp_hrs":92.9,"comp_time_count":279,"median_resp_hrs":10.0,"resp_count":122,"hold_reasons":{"Additional Work Needed":3,"Unable to access unit":2,"Waiting on customer: parts to be supplied":1,"Parts Sourcing Delay":1,"Waiting for Diagnosis":1},"cancel_reasons":{"Duplicate":9,"Work no longer required":9,"Unit at dealer":6,"IT Issue":5,"Unit no longer on site":5,"Unable to source parts":3,"Unable to source tools":1}}}};
var MOM={"months":["2025-10","2025-11","2025-12","2026-01","2026-02"],"mom":{"HMS2":{"2025-10":{"t":56,"c":54,"x":2,"h":0,"o":0,"avgCost":181.26,"totCost":7250.58,"medComp":15.2,"avgComp":34.9,"medResp":8.7},"2025-11":{"t":33,"c":33,"x":0,"h":0,"o":0,"avgCost":1465.78,"totCost":17589.31,"medComp":58.6,"avgComp":125.7,"medResp":12.0},"2025-12":{"t":18,"c":18,"x":0,"h":0,"o":0,"avgCost":636.44,"totCost":6364.45,"medComp":29.3,"avgComp":43.2,"medResp":5.0},"2026-01":{"t":38,"c":31,"x":7,"h":0,"o":0,"avgCost":891.06,"totCost":16039.04,"medComp":34.8,"avgComp":38.5,"medResp":5.2},"2026-02":{"t":7,"c":3,"x":0,"h":0,"o":4,"avgCost":524.7,"totCost":1049.4,"medComp":43.5,"avgComp":35.0,"medResp":33.1}},"OVERALL":{"2025-10":{"t":256,"c":220,"x":36,"h":0,"o":0,"avgCost":486.16,"totCost":81188.58,"medComp":45.1,"avgComp":100.3,"medResp":12.9},"2025-11":{"t":338,"c":275,"x":63,"h":0,"o":0,"avgCost":907.54,"totCost":122517.61,"medComp":74.6,"avgComp":141.9,"medResp":16.3},"2025-12":{"t":566,"c":505,"x":61,"h":0,"o":0,"avgCost":745.38,"totCost":172182.24,"medComp":30.2,"avgComp":62.4,"medResp":8.0},"2026-01":{"t":676,"c":624,"x":43,"h":1,"o":8,"avgCost":753.61,"totCost":227591.51,"medComp":30.1,"avgComp":54.3,"medResp":9.3},"2026-02":{"t":422,"c":296,"x":29,"h":6,"o":91,"avgCost":750.9,"totCost":140418.64,"medComp":23.6,"avgComp":41.4,"medResp":7.1}},"HDT3":{"2025-10":{"t":67,"c":56,"x":11,"h":0,"o":0,"avgCost":599.12,"totCost":26361.48,"medComp":61.8,"avgComp":102.5,"medResp":22.2},"2025-11":{"t":45,"c":39,"x":6,"h":0,"o":0,"avgCost":812.84,"totCost":22759.64,"medComp":65.2,"avgComp":91.5,"medResp":18.8},"2025-12":{"t":78,"c":71,"x":7,"h":0,"o":0,"avgCost":706.14,"totCost":33188.74,"medComp":32.2,"avgComp":54.8,"medResp":13.6},"2026-01":{"t":114,"c":109,"x":3,"h":0,"o":2,"avgCost":855.77,"totCost":51346.3,"medComp":37.8,"avgComp":61.7,"medResp":10.3},"2026-02":{"t":59,"c":41,"x":2,"h":0,"o":16,"avgCost":937.76,"totCost":34697.17,"medComp":29.2,"avgComp":43.3,"medResp":4.1}},"HIN3":{"2025-10":{"t":20,"c":15,"x":5,"h":0,"o":0,"avgCost":608.79,"totCost":8523.12,"medComp":14.6,"avgComp":57.4,"medResp":7.0},"2025-11":{"t":12,"c":7,"x":5,"h":0,"o":0,"avgCost":938.51,"totCost":3754.02,"medComp":97.9,"avgComp":157.0,"medResp":0},"2025-12":{"t":16,"c":15,"x":1,"h":0,"o":0,"avgCost":840.95,"totCost":5886.65,"medComp":52.5,"avgComp":67.4,"medResp":17.5},"2026-01":{"t":9,"c":8,"x":1,"h":0,"o":0,"avgCost":606.64,"totCost":1819.91,"medComp":11.2,"avgComp":22.9,"medResp":9.9},"2026-02":{"t":10,"c":5,"x":2,"h":0,"o":3,"avgCost":949.67,"totCost":4748.37,"medComp":5.5,"avgComp":8.2,"medResp":5.3}},"HTP2":{"2025-10":{"t":60,"c":55,"x":5,"h":0,"o":0,"avgCost":534.05,"totCost":24566.32,"medComp":143.2,"avgComp":165.3,"medResp":44.5},"2025-11":{"t":73,"c":54,"x":19,"h":0,"o":0,"avgCost":1056.25,"totCost":32743.61,"medComp":94.8,"avgComp":115.3,"medResp":22.3},"2025-12":{"t":94,"c":86,"x":8,"h":0,"o":0,"avgCost":787.28,"totCost":30703.98,"medComp":47.6,"avgComp":78.3,"medResp":8.0},"2026-01":{"t":53,"c":49,"x":4,"h":0,"o":0,"avgCost":874.72,"totCost":19243.76,"medComp":28.1,"avgComp":45.5,"medResp":3.8},"2026-02":{"t":42,"c":35,"x":2,"h":1,"o":4,"avgCost":628.74,"totCost":13832.35,"medComp":26.7,"avgComp":46.8,"medResp":2.2}},"HSL1":{"2025-10":{"t":20,"c":15,"x":5,"h":0,"o":0,"avgCost":703.53,"totCost":6331.76,"medComp":84.9,"avgComp":106.4,"medResp":16.5},"2025-11":{"t":29,"c":20,"x":9,"h":0,"o":0,"avgCost":613.88,"totCost":4911.06,"medComp":46.2,"avgComp":61.7,"medResp":12.1},"2025-12":{"t":36,"c":33,"x":3,"h":0,"o":0,"avgCost":604.5,"totCost":7253.95,"medComp":8.3,"avgComp":31.1,"medResp":5.5},"2026-01":{"t":21,"c":21,"x":0,"h":0,"o":0,"avgCost":880.75,"totCost":7046.03,"medComp":11.9,"avgComp":40.1,"medResp":7.9},"2026-02":{"t":18,"c":14,"x":1,"h":0,"o":3,"avgCost":542.13,"totCost":3794.88,"medComp":59.2,"avgComp":57.3,"medResp":8.3}},"HPD1":{"2025-10":{"t":4,"c":1,"x":3,"h":0,"o":0,"avgCost":1344.49,"totCost":1344.49,"medComp":142.7,"avgComp":142.7,"medResp":3.9},"2025-11":{"t":5,"c":4,"x":1,"h":0,"o":0,"avgCost":37.55,"totCost":37.55,"medComp":78.4,"avgComp":75.4,"medResp":23.8},"2025-12":{"t":3,"c":2,"x":1,"h":0,"o":0,"avgCost":0,"totCost":0,"medComp":27.5,"avgComp":22.7,"medResp":12.6},"2026-01":{"t":1,"c":1,"x":0,"h":0,"o":0,"avgCost":0,"totCost":0,"medComp":62.0,"avgComp":62.0,"medResp":35.4},"2026-02":{"t":0,"c":0,"x":0,"h":0,"o":0,"avgCost":0,"medComp":0,"avgComp":0,"medResp":0,"totCost":0}},"HCT2":{"2025-10":{"t":9,"c":8,"x":1,"h":0,"o":0,"avgCost":322.33,"totCost":1611.63,"medComp":51.1,"avgComp":72.3,"medResp":17.9},"2025-11":{"t":18,"c":18,"x":0,"h":0,"o":0,"avgCost":551.02,"totCost":6061.18,"medComp":54.5,"avgComp":84.5,"medResp":16.1},"2025-12":{"t":27,"c":24,"x":3,"h":0,"o":0,"avgCost":1264.07,"totCost":15168.88,"medComp":39.2,"avgComp":47.3,"medResp":6.2},"2026-01":{"t":23,"c":21,"x":2,"h":0,"o":0,"avgCost":1531.98,"totCost":12255.81,"medComp":38.1,"avgComp":70.1,"medResp":23.5},"2026-02":{"t":1,"c":1,"x":0,"h":0,"o":0,"avgCost":198.0,"totCost":198.0,"medComp":26.4,"avgComp":26.4,"medResp":0}},"HSD2":{"2025-10":{"t":6,"c":5,"x":1,"h":0,"o":0,"avgCost":789.51,"totCost":1579.02,"medComp":18.2,"avgComp":139.0,"medResp":18.1},"2025-11":{"t":0,"c":0,"x":0,"h":0,"o":0,"avgCost":0,"medComp":0,"avgComp":0,"medResp":0,"totCost":0},"2025-12":{"t":1,"c":1,"x":0,"h":0,"o":0,"avgCost":65.0,"totCost":65.0,"medComp":29.7,"avgComp":29.7,"medResp":0},"2026-01":{"t":3,"c":1,"x":2,"h":0,"o":0,"avgCost":0,"totCost":0,"medComp":39.8,"avgComp":39.8,"medResp":0},"2026-02":{"t":0,"c":0,"x":0,"h":0,"o":0,"avgCost":0,"medComp":0,"avgComp":0,"medResp":0,"totCost":0}},"HAU1":{"2025-10":{"t":10,"c":8,"x":2,"h":0,"o":0,"avgCost":692.56,"totCost":3462.8,"medComp":92.5,"avgComp":164.4,"medResp":1.5},"2025-11":{"t":14,"c":9,"x":5,"h":0,"o":0,"avgCost":435.15,"totCost":2610.92,"medComp":118.5,"avgComp":167.0,"medResp":3.9},"2025-12":{"t":28,"c":25,"x":3,"h":0,"o":0,"avgCost":540.13,"totCost":6481.54,"medComp":21.9,"avgComp":34.0,"medResp":2.4},"2026-01":{"t":45,"c":41,"x":4,"h":0,"o":0,"avgCost":1238.61,"totCost":29726.61,"medComp":25.6,"avgComp":51.2,"medResp":4.9},"2026-02":{"t":31,"c":30,"x":0,"h":0,"o":1,"avgCost":164.95,"totCost":2144.29,"medComp":7.2,"avgComp":11.0,"medResp":3.0}},"HDY1":{"2025-10":{"t":4,"c":3,"x":1,"h":0,"o":0,"avgCost":157.39,"totCost":157.39,"medComp":22.6,"avgComp":56.5,"medResp":0.1},"2025-11":{"t":11,"c":8,"x":3,"h":0,"o":0,"avgCost":1120.77,"totCost":5603.85,"medComp":167.9,"avgComp":209.0,"medResp":18.5},"2025-12":{"t":41,"c":37,"x":4,"h":0,"o":0,"avgCost":1211.76,"totCost":9694.11,"medComp":65.3,"avgComp":96.9,"medResp":2.0},"2026-01":{"t":34,"c":32,"x":2,"h":0,"o":0,"avgCost":814.24,"totCost":10585.06,"medComp":50.3,"avgComp":71.7,"medResp":16.5},"2026-02":{"t":12,"c":10,"x":0,"h":0,"o":2,"avgCost":527.33,"totCost":1054.66,"medComp":10.8,"avgComp":22.6,"medResp":8.5}},"HHO3":{"2025-10":{"t":0,"c":0,"x":0,"h":0,"o":0,"avgCost":0,"medComp":0,"avgComp":0,"medResp":0,"totCost":0},"2025-11":{"t":58,"c":49,"x":9,"h":0,"o":0,"avgCost":1022.22,"totCost":20444.49,"medComp":103.2,"avgComp":178.3,"medResp":13.1},"2025-12":{"t":78,"c":66,"x":12,"h":0,"o":0,"avgCost":684.09,"totCost":24627.12,"medComp":28.4,"avgComp":57.4,"medResp":6.2},"2026-01":{"t":76,"c":74,"x":2,"h":0,"o":0,"avgCost":405.19,"totCost":19854.17,"medComp":26.1,"avgComp":40.8,"medResp":6.7},"2026-02":{"t":54,"c":36,"x":7,"h":3,"o":8,"avgCost":574.53,"totCost":16086.79,"medComp":32.0,"avgComp":44.6,"medResp":6.0}},"HLA2":{"2025-10":{"t":0,"c":0,"x":0,"h":0,"o":0,"avgCost":0,"medComp":0,"avgComp":0,"medResp":0,"totCost":0},"2025-11":{"t":40,"c":34,"x":6,"h":0,"o":0,"avgCost":666.89,"totCost":6001.98,"medComp":248.4,"avgComp":265.4,"medResp":14.5},"2025-12":{"t":91,"c":80,"x":11,"h":0,"o":0,"avgCost":767.46,"totCost":27628.55,"medComp":30.2,"avgComp":69.2,"medResp":11.9},"2026-01":{"t":133,"c":129,"x":4,"h":0,"o":0,"avgCost":634.34,"totCost":26642.46,"medComp":17.4,"avgComp":30.4,"medResp":9.8},"2026-02":{"t":110,"c":79,"x":12,"h":1,"o":18,"avgCost":687.77,"totCost":31637.21,"medComp":21.8,"avgComp":41.0,"medResp":14.0}},"HMK4":{"2025-10":{"t":0,"c":0,"x":0,"h":0,"o":0,"avgCost":0,"medComp":0,"avgComp":0,"medResp":0,"totCost":0},"2025-11":{"t":0,"c":0,"x":0,"h":0,"o":0,"avgCost":0,"medComp":0,"avgComp":0,"medResp":0,"totCost":0},"2025-12":{"t":44,"c":42,"x":2,"h":0,"o":0,"avgCost":443.84,"totCost":3994.6,"medComp":12.6,"avgComp":45.9,"medResp":9.1},"2026-01":{"t":51,"c":46,"x":3,"h":1,"o":1,"avgCost":629.17,"totCost":14470.99,"medComp":20.4,"avgComp":47.6,"medResp":16.1},"2026-02":{"t":20,"c":14,"x":2,"h":0,"o":4,"avgCost":518.0,"totCost":4143.97,"medComp":48.3,"avgComp":54.1,"medResp":42.5}},"HCL2":{"2025-10":{"t":0,"c":0,"x":0,"h":0,"o":0,"avgCost":0,"medComp":0,"avgComp":0,"medResp":0,"totCost":0},"2025-11":{"t":0,"c":0,"x":0,"h":0,"o":0,"avgCost":0,"medComp":0,"avgComp":0,"medResp":0,"totCost":0},"2025-12":{"t":11,"c":5,"x":6,"h":0,"o":0,"avgCost":562.34,"totCost":1124.67,"medComp":214.5,"avgComp":239.6,"medResp":0},"2026-01":{"t":75,"c":61,"x":9,"h":0,"o":5,"avgCost":580.04,"totCost":18561.37,"medComp":108.3,"avgComp":125.2,"medResp":22.4},"2026-02":{"t":58,"c":28,"x":1,"h":1,"o":28,"avgCost":1689.47,"totCost":27031.55,"medComp":53.3,"avgComp":60.9,"medResp":16.0}}}};
var ADOPTION={HTP2:{station:'HTP2',location:'Gibsonton, FL',kooner:89,leaked:18,adoption:83.2},HSL1:{station:'HSL1',location:'Salt Lake City, UT',kooner:30,leaked:2,adoption:93.8},HHO3:{station:'HHO3',location:'Porter, TX',kooner:96,leaked:24,adoption:80.0},HDY1:{station:'HDY1',location:'Clayton, OH',kooner:54,leaked:13,adoption:80.6},HCT2:{station:'HCT2',location:'Chattanooga, TN',kooner:24,leaked:4,adoption:85.7},HCL2:{station:'HCL2',location:'Charlotte, NC',kooner:70,leaked:62,adoption:53.0},HDT3:{station:'HDT3',location:'Romulus, MI',kooner:152,leaked:141,adoption:51.9},HMS2:{station:'HMS2',location:'Lakeville, MN',kooner:37,leaked:33,adoption:52.9},HIN3:{station:'HIN3',location:'South Bend, IN',kooner:16,leaked:20,adoption:44.4},HLA2:{station:'HLA2',location:'Santa Clarita, CA',kooner:189,leaked:250,adoption:43.1},HAU1:{station:'HAU1',location:'Austin, TX',kooner:53,leaked:78,adoption:40.5},HPD1:{station:'HPD1',location:'Portland, OR',kooner:1,leaked:34,adoption:2.9}};
var SENTIMENT=[{dsp:"ALAB",station:"HDT3",responses:1,sat:1.0,time:1.0,qual:1.0,avg:1.0},{dsp:"ARMA",station:"HLA2",responses:5,sat:2.6,time:2.6,qual:2.6,avg:2.6},{dsp:"ORMP",station:"HTP2",responses:2,sat:2.0,time:2.0,qual:3.0,avg:2.3},{dsp:"MAEP",station:"HIN3",responses:1,sat:2.0,time:2.0,qual:3.0,avg:2.3},{dsp:"SFRM",station:"HDT3",responses:3,sat:3.3,time:3.0,qual:3.0,avg:3.1},{dsp:"PRLC",station:"HSL1",responses:1,sat:4.0,time:5.0,qual:3.0,avg:4.0},{dsp:"D4DS",station:"HCL2",responses:1,sat:5.0,time:5.0,qual:5.0,avg:5.0}];
var FEEDBACK=[{date:"Feb 10",dsp:"SFRM",station:"HDT3",sat:4,time:4,qual:4,issue:"Unit 2974 pending diagnostics for a few days",suggestion:"More availability for weekend issues, over the road calls."},{date:"Feb 9",dsp:"ORMP",station:"HTP2",sat:2,time:2,qual:4,issue:"Multiple WOs not looked at since 2/4. Helpful contact laid off.",suggestion:""},{date:"Feb 9",dsp:"ARMA",station:"HLA2",sat:5,time:5,qual:5,issue:"",suggestion:"Jose Madrigal is GREAT! Very professional and attentive."},{date:"Feb 2",dsp:"SFRM",station:"HDT3",sat:3,time:3,qual:3,issue:"",suggestion:"Need 2 day techs. Better communication."},{date:"Jan 26",dsp:"ALAB",station:"HDT3",sat:1,time:1,qual:1,issue:"Lack of timely repairs. Same issue after ungrounding.",suggestion:"Timely repairs needed."},{date:"Jan 12",dsp:"D4DS",station:"HCL2",sat:5,time:5,qual:5,issue:"",suggestion:"Supervisor got more vehicles running in one evening than any mechanic in 5 years."},{date:"Jan 6",dsp:"ORMP",station:"HTP2",sat:2,time:2,qual:2,issue:"No paperwork after 7 days. Brakes still bad.",suggestion:"Need schedule access."},{date:"Jan 5",dsp:"ARMA",station:"HLA2",sat:1,time:1,qual:1,issue:"No work orders submitted.",suggestion:"Better communication."}];

var cur='HDY1',names=Object.keys(WO.stations).sort(),chartInstances=[];
var MLABELS=MOM.months.map(function(m){var parts=m.split('-');var mi=parseInt(parts[1]);var mNames=['','Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];return mNames[mi]+" '"+parts[0].slice(2)});

function gm(k){return k==='OVERALL'?WO.overall:WO.stations[k]}
function p2(n,d){return d?(n/d*100).toFixed(1):'0.0'}
function cc(v,hi){if(hi!==false)return v>=85?'gr':v>=70?'ye':'re';return v<=5?'gr':v<=12?'ye':'re'}
function topN(o,n){return Object.entries(o).sort(function(a,b){return b[1]-a[1]}).slice(0,n||5)}
function scv(v){return v>=4?'gr':v>=3?'ye':v>=2?'or':'re'}
function scoreColor(v){return v>=4?'var(--gn)':v>=3?'var(--yl)':v>=2?'var(--or)':'var(--rd)'}
function kpi(label,val,colorCls,borderCls,sub){return'<div class="kp '+(borderCls||'')+'"><div class="lb">'+label+'</div><div class="vl '+(colorCls||'')+'">'+val+'</div>'+(sub?'<div class="sb">'+sub+'</div>':'')+'</div>'}
function deltaTag(curr,prev,inv){if(!prev||!curr)return'<span class="delta nt">—</span>';var d=curr-prev,pct=prev?(d/prev*100).toFixed(0):'';var up=inv?d<0:d>0;if(Math.abs(d)<0.01)return'<span class="delta nt">0%</span>';return'<span class="delta '+(up?'up':'dn')+'">'+(d>0?'+':'')+pct+'%</span>'}

function getMoM(stn){var d=MOM.mom[stn];if(!d)return null;var out=[];MOM.months.forEach(function(m){out.push(d[m]||{t:0,c:0,x:0,h:0,o:0,avgCost:0,medComp:0,avgComp:0,medResp:0,totCost:0})});return out}

function buildMoMSection(stn){
  var md=getMoM(stn);if(!md)return'';
  var last=md[md.length-1],prev=md[md.length-2];
  var compLast=last.t?last.c/last.t*100:0,compPrev=prev.t?prev.c/prev.t*100:0;
  var uid=stn.replace(/[^a-zA-Z0-9]/g,'');
  var h='<div class="mom-box"><div class="mom-title">&#x1f4c8; Month-over-Month Trends</div>';
  h+='<div class="kg" style="margin-bottom:16px">';
  h+='<div class="kp or"><div class="lb">Feb Work Orders</div><div class="vl">'+last.t+' '+deltaTag(last.t,prev.t)+'</div><div class="sb">Jan: '+prev.t+'</div></div>';
  h+='<div class="kp '+(compLast>=85?'gr':compLast>=70?'ye':'re')+'"><div class="lb">Feb Completion</div><div class="vl '+cc(compLast)+'">'+compLast.toFixed(1)+'% '+deltaTag(compLast,compPrev)+'</div><div class="sb">Jan: '+compPrev.toFixed(1)+'%</div></div>';
  h+='<div class="kp '+(last.medComp<36?'gr':last.medComp<72?'ye':'re')+'"><div class="lb">Feb Median Completion</div><div class="vl">'+last.medComp+'h '+deltaTag(last.medComp,prev.medComp,true)+'</div><div class="sb">Jan: '+prev.medComp+'h</div></div>';
  h+='<div class="kp '+(last.medResp<12?'gr':last.medResp<24?'ye':'re')+'"><div class="lb">Feb Median Response</div><div class="vl">'+last.medResp+'h '+deltaTag(last.medResp,prev.medResp,true)+'</div><div class="sb">Jan: '+prev.medResp+'h</div></div>';
  h+='</div>';
  h+='<div class="chart-row"><div class="chart-card"><div class="cc-title">Work Order Volume &amp; Completion Rate</div><canvas id="momVol_'+uid+'"></canvas></div>';
  h+='<div class="chart-card"><div class="cc-title">Median Completion &amp; Response Time</div><canvas id="momTime_'+uid+'"></canvas></div></div>';
  h+='<div class="tw scr"><table><thead><tr><th>Month</th><th>Work Orders</th><th>Completion %</th><th>Cancel %</th><th>Med Completion</th><th>Med Response</th></tr></thead><tbody>';
  MOM.months.forEach(function(m,i){var d2=md[i];if(!d2.t){h+='<tr><td>'+MLABELS[i]+'</td><td colspan="5" style="color:var(--dm)">No data</td></tr>';return}var cpct=d2.t?d2.c/d2.t*100:0;var xpct=d2.t?d2.x/d2.t*100:0;h+='<tr><td><strong>'+MLABELS[i]+'</strong></td><td>'+d2.t+'</td><td><span class="bg '+cc(cpct)+'">'+cpct.toFixed(1)+'%</span></td><td><span class="bg '+cc(xpct,false)+'">'+xpct.toFixed(1)+'%</span></td><td>'+d2.medComp+'h</td><td>'+d2.medResp+'h</td></tr>'});
  h+='</tbody></table></div></div>';return h;
}

function buildSentimentSection(stn){
  var sents=stn==='OVERALL'?SENTIMENT:SENTIMENT.filter(function(s){return s.station===stn});
  var fb=stn==='OVERALL'?FEEDBACK:FEEDBACK.filter(function(f){return f.station===stn});
  var adopt=stn==='OVERALL'?(function(){var tk=0,tl=0;Object.values(ADOPTION).forEach(function(a){tk+=a.kooner;tl+=a.leaked});return{kooner:tk,leaked:tl,adoption:parseFloat((tk/(tk+tl)*100).toFixed(1))}})():ADOPTION[stn]||null;
  var h='<div class="sent-box"><div class="sent-title">&#x1f4ac; Sentiment &amp; Adoption</div>';
  if(adopt){var acolor=adopt.adoption>=85?'var(--gn)':adopt.adoption>=70?'var(--yl)':'var(--rd)';var abg=adopt.adoption>=85?'#15803d':adopt.adoption>=70?'#a16207':'#b91c1c';h+='<div class="adopt-bar"><div class="ab-lbl">Adoption</div><div class="ab-track"><div class="ab-fill" style="width:'+adopt.adoption+'%;background:'+abg+'">'+adopt.adoption+'%</div><div class="ab-target" title="85% Target"></div></div><div class="ab-val" style="color:'+acolor+'">'+adopt.adoption+'%</div></div><div style="display:flex;gap:16px;margin-bottom:14px;font-size:11px;color:var(--mu)"><span>Kooner: <strong style="color:var(--gn)">'+adopt.kooner+'</strong></span><span>Leaked: <strong style="color:var(--rd)">'+adopt.leaked+'</strong></span><span>Target: <strong style="color:var(--yl)">85%</strong></span></div>'}else{h+='<div style="margin-bottom:14px;font-size:11px;color:var(--dm);font-style:italic">No adoption data for this station</div>'}
  if(sents.length>0){var tr2=0,aS=0,aT=0,aQ=0,aA=0;sents.forEach(function(s){tr2+=s.responses;aS+=s.sat*s.responses;aT+=s.time*s.responses;aQ+=s.qual*s.responses;aA+=s.avg*s.responses});if(tr2){aS/=tr2;aT/=tr2;aQ/=tr2;aA/=tr2}h+='<div class="sent-kpis"><div class="sent-kpi"><div class="sk-lb">Responses</div><div class="sk-vl">'+tr2+'</div></div><div class="sent-kpi"><div class="sk-lb">Satisfaction</div><div class="sk-vl '+scv(aS)+'">'+aS.toFixed(1)+'</div></div><div class="sent-kpi"><div class="sk-lb">Timeliness</div><div class="sk-vl '+scv(aT)+'">'+aT.toFixed(1)+'</div></div><div class="sent-kpi"><div class="sk-lb">Quality</div><div class="sk-vl '+scv(aQ)+'">'+aQ.toFixed(1)+'</div></div><div class="sent-kpi"><div class="sk-lb">Overall</div><div class="sk-vl '+scv(aA)+'">'+aA.toFixed(1)+'/5</div></div></div>';h+='<div class="tw"><table><thead><tr><th>DSP</th><th>Station</th><th>Resp</th><th>Sat</th><th>Time</th><th>Qual</th><th>Avg</th></tr></thead><tbody>';sents.slice().sort(function(a,b){return a.avg-b.avg}).forEach(function(s){h+='<tr><td><strong>'+s.dsp+'</strong></td><td>'+s.station+'</td><td>'+s.responses+'</td><td><span class="bg '+scv(s.sat)+'">'+s.sat.toFixed(1)+'</span></td><td><span class="bg '+scv(s.time)+'">'+s.time.toFixed(1)+'</span></td><td><span class="bg '+scv(s.qual)+'">'+s.qual.toFixed(1)+'</span></td><td><span class="bg '+scv(s.avg)+'">'+s.avg.toFixed(1)+'</span></td></tr>'});h+='</tbody></table></div>'}else{h+='<div class="no-data">No DSP sentiment survey data for this station</div>'}
  if(fb.length>0){h+='<div class="sc sent">Recent DSP Feedback</div>';fb.forEach(function(f){h+='<div class="fb-card"><div class="fb-hdr"><div><span class="fb-dsp">'+f.dsp+'</span> <span class="fb-date">'+f.date+(stn==='OVERALL'?' &middot; '+f.station:'')+'</span></div><div class="fb-scores"><span>S:<strong style="color:'+scoreColor(f.sat)+'">'+f.sat+'</strong></span><span>T:<strong style="color:'+scoreColor(f.time)+'">'+f.time+'</strong></span><span>Q:<strong style="color:'+scoreColor(f.qual)+'">'+f.qual+'</strong></span></div></div>';if(f.issue)h+='<div class="fb-txt issue">'+f.issue+'</div>';if(f.suggestion)h+='<div class="fb-txt pos">'+f.suggestion+'</div>';h+='</div>'})}
  h+='</div>';return h;
}

function renderCharts(stn){
  chartInstances.forEach(function(c){c.destroy()});chartInstances=[];
  var md=getMoM(stn);if(!md)return;
  var uid=stn.replace(/[^a-zA-Z0-9]/g,'');
  var gridColor='rgba(0,0,0,.06)',tickColor='#94a3b8';
  Chart.defaults.font.family='DM Sans';
  var base={responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:'#64748b',font:{size:10}},position:'top'}},animation:{duration:500}};
  var el1=document.getElementById('momVol_'+uid);
  if(el1){chartInstances.push(new Chart(el1,{type:'bar',data:{labels:MLABELS,datasets:[{type:'bar',label:'WO Volume',data:md.map(function(d){return d.t}),backgroundColor:'rgba(79,95,237,0.5)',borderRadius:5,yAxisID:'y',order:2},{type:'line',label:'Completion %',data:md.map(function(d){return d.t?(d.c/d.t*100):0}),borderColor:'#16a34a',backgroundColor:'rgba(22,163,74,0.08)',tension:.35,pointRadius:5,pointBackgroundColor:'#16a34a',fill:true,yAxisID:'y1',order:1}]},options:Object.assign({},base,{scales:{y:{position:'left',grid:{color:gridColor},ticks:{color:tickColor}},y1:{position:'right',min:0,max:100,grid:{display:false},ticks:{color:'#16a34a',callback:function(v){return v+'%'}}},x:{grid:{display:false},ticks:{color:tickColor}}}})}))}
  var el2=document.getElementById('momTime_'+uid);
  if(el2){chartInstances.push(new Chart(el2,{type:'line',data:{labels:MLABELS,datasets:[{label:'Med Completion (h)',data:md.map(function(d){return d.medComp}),borderColor:'#ea580c',backgroundColor:'rgba(234,88,12,0.08)',tension:.35,pointRadius:5,pointBackgroundColor:'#ea580c',fill:true,yAxisID:'y'},{label:'Med Response (h)',data:md.map(function(d){return d.medResp}),borderColor:'#0891b2',backgroundColor:'rgba(8,145,178,0.08)',tension:.35,pointRadius:5,pointBackgroundColor:'#0891b2',fill:true,yAxisID:'y'}]},options:Object.assign({},base,{scales:{y:{grid:{color:gridColor},ticks:{color:tickColor,callback:function(v){return v+'h'}}},x:{grid:{display:false},ticks:{color:tickColor}}}})}))}
}

function build(){
  var m=gm(cur),cr=parseFloat(p2(m.completed,m.total)),xr=parseFloat(p2(m.cancelled,m.total));
  var h='<div class="app"><div class="hdr"><div><h1>LAST MILE SERVICE PERFORMANCE</h1><div class="sub">'+(cur==='OVERALL'?'All Stations Rollup':'Station: '+cur)+' &mdash; '+m.total.toLocaleString()+' Work Orders</div></div><div class="stamp">Report Date: 2/16/26</div></div>';
  h+='<div class="tabs"><button class="'+(cur==='OVERALL'?'on':'')+'" data-t="OVERALL">&#9632; Overall</button>';
  names.forEach(function(n){h+='<button class="'+(cur===n?'on':'')+'" data-t="'+n+'">'+n+'</button>'});h+='</div>';

  // KPIs — no financial data
  h+='<div class="kg">';
  h+=kpi('Total Work Orders',m.total.toLocaleString(),'','gr','');
  h+=kpi('Completion Rate',cr+'%',cc(cr),cc(cr),m.completed+' completed');
  h+=kpi('Cancellation Rate',xr+'%',cc(xr,false),cc(xr,false),m.cancelled+' cancelled');
  h+=kpi('Open / In Progress',m.open.toLocaleString(),m.open>10?'ye':'gr',m.open>10?'ye':'gr',m.on_hold+' on hold');
  h+='</div><div class="kg">';
  var tc=m.median_comp_hrs<36?'gr':m.median_comp_hrs<72?'ye':'re';
  h+=kpi('Median Completion',m.median_comp_hrs+'h',tc,tc,'Avg: '+m.avg_comp_hrs+'h');
  var rc=m.median_resp_hrs<12?'gr':m.median_resp_hrs<24?'ye':'re';
  h+=kpi('Median Response',m.median_resp_hrs+'h',rc,rc,m.resp_count+' measured');
  h+=kpi('Completion Count',m.comp_time_count.toLocaleString(),'','cy','with timing data');
  h+=kpi('On Hold',m.on_hold.toLocaleString(),m.on_hold>3?'ye':'gr',m.on_hold>3?'ye':'gr','');
  h+='</div>';

  // MoM
  h+=buildMoMSection(cur);
  // Sentiment
  h+=buildSentimentSection(cur);

  // Status
  h+='<div class="sc perf">Status Distribution</div><div class="bars">';
  topN(m.status_counts,10).forEach(function(e){var w=m.total?(e[1]/m.total*100):0;var c=e[0]==='COMPLETED'?'gr':e[0]==='CANCELLED'?'re':'bl';h+='<div class="br"><div class="bl">'+e[0].replace(/_/g,' ')+'</div><div class="bt"><div class="bf '+c+'" style="width:'+Math.max(w,2)+'%">'+w.toFixed(1)+'%</div></div><div class="bc">'+e[1]+'</div></div>'});h+='</div>';

  h+='<div class="duo"><div><div class="sc det">By Priority</div><div class="tw"><table><thead><tr><th>Priority</th><th>Count</th><th>%</th></tr></thead><tbody>';
  topN(m.priorities,5).forEach(function(e){var pv=p2(e[1],m.total);h+='<tr><td><strong>'+e[0]+'</strong></td><td>'+e[1]+'</td><td><span class="bg '+(parseFloat(pv)>35?'ye':'gr')+'">'+pv+'%</span></td></tr>'});
  h+='</tbody></table></div></div><div><div class="sc det">By Category</div><div class="tw"><table><thead><tr><th>Category</th><th>Count</th><th>%</th></tr></thead><tbody>';
  topN(m.categories,6).forEach(function(e){h+='<tr><td><strong>'+e[0].replace(/_/g,' ')+'</strong></td><td>'+e[1]+'</td><td>'+p2(e[1],m.total)+'%</td></tr>'});h+='</tbody></table></div></div></div>';

  h+='<div class="duo"><div><div class="sc det">Scheduled vs Non-Scheduled</div><div class="tw"><table><thead><tr><th>Type</th><th>Count</th><th>%</th></tr></thead><tbody>';
  topN(m.types,4).forEach(function(e){h+='<tr><td><strong>'+e[0].replace(/_/g,' ')+'</strong></td><td>'+e[1]+'</td><td>'+p2(e[1],m.total)+'%</td></tr>'});
  h+='</tbody></table></div></div><div><div class="sc det">Top Workflows</div><div class="tw"><table><thead><tr><th>Workflow</th><th>Count</th><th>%</th></tr></thead><tbody>';
  topN(m.workflows,8).forEach(function(e){h+='<tr><td><strong>'+e[0].replace(/_/g,' ')+'</strong></td><td>'+e[1]+'</td><td>'+p2(e[1],m.total)+'%</td></tr>'});h+='</tbody></table></div></div></div>';

  // Cancel & Hold
  var cre=topN(m.cancel_reasons,6),hre=topN(m.hold_reasons,6);
  if(cre.length||hre.length){h+='<div class="duo">';if(cre.length){h+='<div><div class="sc perf">Cancellation Reasons</div><div class="tw"><table><thead><tr><th>Reason</th><th>Count</th></tr></thead><tbody>';cre.forEach(function(e){h+='<tr><td>'+e[0].replace(/_/g,' ')+'</td><td><span class="bg re">'+e[1]+'</span></td></tr>'});h+='</tbody></table></div></div>'}if(hre.length){h+='<div><div class="sc perf">Hold Reasons</div><div class="tw"><table><thead><tr><th>Reason</th><th>Count</th></tr></thead><tbody>';hre.forEach(function(e){h+='<tr><td>'+e[0].replace(/_/g,' ')+'</td><td><span class="bg ye">'+e[1]+'</span></td></tr>'});h+='</tbody></table></div></div>'}h+='</div>'}

  // Station comparison — no cost columns
  if(cur==='OVERALL'){
    h+='<div class="sc perf">Station Comparison</div><div class="tw scr"><table><thead><tr><th>Station</th><th>WOs</th><th>Comp %</th><th>Cancel %</th><th>Open</th><th>Med Comp</th><th>Med Resp</th><th>Adoption</th><th>Sentiment</th></tr></thead><tbody>';
    names.forEach(function(sn){var sm=WO.stations[sn],scr2=parseFloat(p2(sm.completed,sm.total)),sxr=parseFloat(p2(sm.cancelled,sm.total));var ad=ADOPTION[sn],adVal=ad?ad.adoption.toFixed(1)+'%':'—',adC=ad?(ad.adoption>=85?'gr':ad.adoption>=70?'ye':'re'):'';var ss=SENTIMENT.filter(function(x){return x.station===sn});var sentVal='—',sentC='';if(ss.length){var tr2=0,ta=0;ss.forEach(function(x){tr2+=x.responses;ta+=x.avg*x.responses});if(tr2){var av=ta/tr2;sentVal=av.toFixed(1)+'/5';sentC=scv(av)}}h+='<tr><td><strong>'+sn+'</strong></td><td>'+sm.total+'</td><td><span class="bg '+cc(scr2)+'">'+scr2+'%</span></td><td><span class="bg '+cc(sxr,false)+'">'+sxr+'%</span></td><td>'+sm.open+'</td><td>'+sm.median_comp_hrs+'h</td><td>'+sm.median_resp_hrs+'h</td><td>'+(adC?'<span class="bg '+adC+'">'+adVal+'</span>':adVal)+'</td><td>'+(sentC?'<span class="bg '+sentC+'">'+sentVal+'</span>':sentVal)+'</td></tr>'});
    h+='</tbody></table></div>';
  }

  h+='</div>';
  document.getElementById('root').innerHTML=h;
  document.querySelectorAll('.tabs button').forEach(function(btn){btn.addEventListener('click',function(){cur=btn.dataset.t;build();window.scrollTo(0,0)})});
  setTimeout(function(){renderCharts(cur)},50);
}
build();
</script>
</body>
</html>