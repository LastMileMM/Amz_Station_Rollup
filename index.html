<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Last Mile Service Performance Report</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
:root{--bg:#f8f9fc;--sf:#ffffff;--sf2:#f1f3f8;--bd:#e2e6ef;--ac:#4f5fed;--ac2:#7c6cff;--gn:#16a34a;--gnb:rgba(22,163,74,.08);--yl:#ca8a04;--ylb:rgba(202,138,4,.08);--rd:#dc2626;--rdb:rgba(220,38,38,.08);--or:#ea580c;--orb:rgba(234,88,12,.08);--cy:#0891b2;--cyb:rgba(8,145,178,.08);--tx:#1e293b;--mu:#64748b;--dm:#94a3b8;--fn:'DM Sans',sans-serif;--mo:'JetBrains Mono',monospace}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:var(--fn);background:var(--bg);color:var(--tx);min-height:100vh;-webkit-font-smoothing:antialiased}
::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:#ccc;border-radius:3px}
.app{max-width:1440px;margin:0 auto;padding:28px 32px}

.hdr{display:flex;align-items:flex-end;justify-content:space-between;margin-bottom:28px;padding-bottom:22px;border-bottom:2px solid var(--bd)}
.hdr h1{font-size:22px;font-weight:700;letter-spacing:-.02em;color:var(--ac)}
.hdr .sub{color:var(--mu);font-size:12.5px;margin-top:4px}
.hdr .stamp{font-family:var(--mo);font-size:10px;color:var(--dm);background:var(--sf2);padding:5px 12px;border-radius:6px;border:1px solid var(--bd)}

.tabs{display:flex;gap:4px;margin-bottom:26px;overflow-x:auto;padding-bottom:3px}
.tabs button{padding:9px 18px;border-radius:8px;border:1px solid transparent;background:transparent;color:var(--mu);font-family:var(--fn);font-size:12px;font-weight:600;cursor:pointer;transition:all .15s;white-space:nowrap}
.tabs button:hover{color:var(--tx);background:var(--sf);border-color:var(--bd)}
.tabs button.on{background:var(--ac);color:#fff;border-color:var(--ac)}

.kg{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-bottom:22px}
@media(max-width:1100px){.kg{grid-template-columns:repeat(2,1fr)}}@media(max-width:600px){.kg{grid-template-columns:1fr}}
.kp{background:var(--sf);border:1px solid var(--bd);border-radius:12px;padding:18px 20px;position:relative;overflow:hidden;box-shadow:0 1px 3px rgba(0,0,0,.04)}
.kp::after{content:'';position:absolute;top:0;left:0;right:0;height:3px;border-radius:12px 12px 0 0}
.kp.gr::after{background:var(--gn)}.kp.ye::after{background:var(--yl)}.kp.re::after{background:var(--rd)}.kp.cy::after{background:var(--cy)}.kp.or::after{background:var(--or)}
.kp .lb{font-size:10px;text-transform:uppercase;letter-spacing:.07em;color:var(--mu);margin-bottom:7px;font-weight:600}
.kp .vl{font-family:var(--mo);font-size:26px;font-weight:700;line-height:1}
.kp .vl.gr{color:var(--gn)}.kp .vl.ye{color:var(--yl)}.kp .vl.re{color:var(--rd)}.kp .vl.or{color:var(--or)}.kp .vl.cy{color:var(--cy)}
.kp .sb{font-size:10px;color:var(--dm);margin-top:6px}
.delta{font-size:10px;font-family:var(--mo);font-weight:600;margin-left:4px}
.delta.up{color:var(--gn)}.delta.dn{color:var(--rd)}.delta.nt{color:var(--dm)}

.sc{font-size:14px;font-weight:700;margin:22px 0 14px;color:var(--tx);display:flex;align-items:center;gap:8px;letter-spacing:-.01em}
.sc::before{content:'';width:4px;height:16px;border-radius:2px}
.sc.perf::before{background:var(--ac)}.sc.sent::before{background:var(--cy)}.sc.mom::before{background:var(--or)}.sc.det::before{background:var(--gn)}

.tw{background:var(--sf);border:1px solid var(--bd);border-radius:12px;overflow:hidden;margin-bottom:18px;box-shadow:0 1px 3px rgba(0,0,0,.03)}
.tw.scr{overflow-x:auto}
table{width:100%;border-collapse:collapse;font-size:12.5px}
th{padding:10px 16px;text-align:left;font-weight:600;color:var(--mu);text-transform:uppercase;font-size:9.5px;letter-spacing:.06em;border-bottom:1px solid var(--bd);background:var(--sf2);white-space:nowrap}
td{padding:9px 16px;border-bottom:1px solid var(--bd)}
tr:last-child td{border-bottom:none}tr:hover{background:rgba(79,95,237,.02)}
td strong{font-weight:600;color:var(--tx)}

.bg{display:inline-block;padding:3px 10px;border-radius:20px;font-size:10px;font-weight:700;font-family:var(--mo);letter-spacing:.02em}
.bg.gr{background:var(--gnb);color:var(--gn)}.bg.ye{background:var(--ylb);color:var(--yl)}.bg.re{background:var(--rdb);color:var(--rd)}.bg.or{background:var(--orb);color:var(--or)}.bg.cy{background:var(--cyb);color:var(--cy)}

.bars{margin-bottom:22px}
.br{display:flex;align-items:center;gap:10px;margin-bottom:7px}
.br .bl{width:100px;font-size:11px;color:var(--mu);text-align:right;flex-shrink:0;font-weight:500}
.br .bt{flex:1;height:22px;background:var(--sf2);border-radius:5px;overflow:hidden;border:1px solid var(--bd)}
.br .bf{height:100%;border-radius:4px;display:flex;align-items:center;padding-left:8px;font-size:10px;font-weight:700;color:#fff;font-family:var(--mo);min-width:32px;transition:width .5s ease}
.bf.gr{background:linear-gradient(90deg,#15803d,var(--gn))}.bf.ye{background:linear-gradient(90deg,#a16207,var(--yl))}.bf.re{background:linear-gradient(90deg,#b91c1c,var(--rd))}.bf.bl{background:linear-gradient(90deg,#3730a3,var(--ac))}.bf.cy{background:linear-gradient(90deg,#0e7490,var(--cy))}
.br .bc{width:40px;font-size:11px;color:var(--dm);font-family:var(--mo);font-weight:500}

.duo{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:18px}
@media(max-width:800px){.duo{grid-template-columns:1fr}}

/* Sentiment */
.sent-box{background:linear-gradient(135deg,rgba(8,145,178,.04),rgba(79,95,237,.04));border:1px solid rgba(8,145,178,.18);border-radius:14px;padding:22px;margin-bottom:22px}
.sent-box .sent-title{font-size:15px;font-weight:700;margin-bottom:16px;display:flex;align-items:center;gap:8px;color:var(--cy)}
.sent-kpis{display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:12px;margin-bottom:16px}
.sent-kpi{background:var(--sf);border:1px solid var(--bd);border-radius:10px;padding:14px;text-align:center;box-shadow:0 1px 2px rgba(0,0,0,.03)}
.sent-kpi .sk-lb{font-size:9px;text-transform:uppercase;letter-spacing:.06em;color:var(--mu);margin-bottom:5px}
.sent-kpi .sk-vl{font-family:var(--mo);font-size:22px;font-weight:700}
.adopt-bar{display:flex;align-items:center;gap:10px;margin-bottom:12px}
.adopt-bar .ab-lbl{font-size:11px;color:var(--mu);min-width:70px}
.adopt-bar .ab-track{flex:1;height:20px;background:var(--sf2);border-radius:5px;overflow:hidden;position:relative;border:1px solid var(--bd)}
.adopt-bar .ab-fill{height:100%;border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:9.5px;font-weight:700;color:#fff;font-family:var(--mo)}
.adopt-bar .ab-target{position:absolute;top:0;bottom:0;width:2px;background:var(--yl);left:85%}
.adopt-bar .ab-val{font-family:var(--mo);font-size:12px;font-weight:600;min-width:48px;text-align:right}
.fb-card{background:var(--sf);border:1px solid var(--bd);border-radius:10px;padding:16px;margin-bottom:10px;box-shadow:0 1px 2px rgba(0,0,0,.03)}
.fb-hdr{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;flex-wrap:wrap;gap:6px}
.fb-dsp{font-family:var(--mo);font-weight:600;font-size:12px}
.fb-date{font-size:10px;color:var(--dm)}
.fb-scores{display:flex;gap:10px;font-family:var(--mo);font-size:10px;color:var(--mu)}
.fb-scores span{display:flex;align-items:center;gap:3px}
.fb-txt{font-size:11.5px;color:var(--mu);line-height:1.5;font-style:italic;padding:8px 0 0;border-top:1px solid var(--bd);margin-top:6px}
.fb-txt.issue{border-left:2px solid var(--rd);padding-left:10px;margin-bottom:6px;border-top:none;padding-top:0}
.fb-txt.pos{border-left:2px solid var(--gn);padding-left:10px;border-top:none;padding-top:0}
.no-data{text-align:center;padding:22px;color:var(--dm);font-size:12px;font-style:italic}

/* MoM */
.mom-box{background:linear-gradient(135deg,rgba(234,88,12,.04),rgba(202,138,4,.04));border:1px solid rgba(234,88,12,.18);border-radius:14px;padding:22px;margin-bottom:22px}
.mom-box .mom-title{font-size:15px;font-weight:700;margin-bottom:16px;display:flex;align-items:center;gap:8px;color:var(--or)}
.chart-row{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:16px}
@media(max-width:900px){.chart-row{grid-template-columns:1fr}}
.chart-card{background:var(--sf);border:1px solid var(--bd);border-radius:10px;padding:18px;box-shadow:0 1px 2px rgba(0,0,0,.03)}
.chart-card .cc-title{font-size:11px;font-weight:600;color:var(--mu);text-transform:uppercase;letter-spacing:.05em;margin-bottom:14px}
.chart-card canvas{width:100%!important;height:210px!important}
</style>
</head>
<body>
<div id="root"></div>
<script>
var WO={"overall":{"label":"OVERALL","total":2414,"completed":2122,"cancelled":244,"on_hold":2,"open":46,"status_counts":{"COMPLETED":2122,"CANCELLED":244,"DISPATCH_ACCEPTED":17,"DISPATCHED":16,"AWAITING_ESTIMATE_APPROVAL":8,"ASSIGNED":4,"ON_HOLD":2,"IN_REPAIR":1},"priorities":{"MEDIUM":2316,"CRITICAL":52,"LOW":45,"HIGH":1},"categories":{"PREVENTATIVE_MAINTENANCE":921,"MECHANICAL":295,"ELECTRICAL":69,"BODYWORK":41,"STRUCTURAL":1},"types":{"NON_SCHEDULED":2370,"SCHEDULED":44},"workflows":{"CHECK_AND_ADVISE":1206,"REPAIR":396,"PM_A":372,"PM_B":237,"DOT":136,"PM_DOT":15,"DOT_INSPECTION":14,"CTC":11,"AIR_FILTER":3,"BRAKE_SYSTEM_FLUSH":2,"DPFE_SENSOR":1,"OIL_CHANGE":1,"FILTER_CRANKCASE_VENTILATION":1,"COOLANT_SERVICES":1,"SERPENTINE_BELT":1,"LIFT_GATE_PM":1},"technicians":{"LM - Jose Madrigal":203,"LM - Terence Lucas":185,"LM - Thomas McRoberts":179,"LM - Jett Bukovac":167,"LM - Evereth Salas":159,"LM - Marcos Tun":119,"LM - Hector Brito":116,"LM - Justin Forte":113,"LM - Alejandro Fernandez":94,"LM - Victor Wells":83,"FM - Eugene Fowler":79,"LM - Brooks Lawson":71,"LM - Lamont Henderson":70,"LM - Fernando Cruz":66,"LM NC - Justin Owens":52},"avg_cost":730.98,"total_cost":830389.94,"cost_count":1136,"avg_labor":0,"avg_parts":0,"median_comp_hrs":34.4,"avg_comp_hrs":73.8,"comp_time_count":2122,"median_resp_hrs":9.2,"resp_count":1049,"hold_reasons":{"Additional Work Needed":12,"Parts Sourcing Delay":6,"Waiting for Diagnosis":4,"Part delay: waiting for delivery":3,"Unable to access unit":2,"Part delay: back ordered":1,"Waiting on customer: parts to be supplied":1},"cancel_reasons":{"Duplicate":117,"Work no longer required":76,"IT Issue":16,"Unit no longer on site":13,"Unit at dealer":11,"Unit at third party workshop":4,"Unable to source parts":3,"Unable to source tools":2}},"stations":{"HAU1":{"label":"HAU1","total":140,"completed":125,"cancelled":14,"on_hold":0,"open":1,"status_counts":{"COMPLETED":125,"CANCELLED":14,"DISPATCHED":1},"priorities":{"MEDIUM":138,"LOW":2},"categories":{"PREVENTATIVE_MAINTENANCE":84,"MECHANICAL":21,"ELECTRICAL":10,"BODYWORK":7},"types":{"NON_SCHEDULED":138,"SCHEDULED":2},"workflows":{"CHECK_AND_ADVISE":56,"PM_A":39,"REPAIR":23,"PM_B":13,"DOT":3,"PM_DOT":1,"DPFE_SENSOR":1,"FILTER_CRANKCASE_VENTILATION":1,"COOLANT_SERVICES":1,"AIR_FILTER":1},"technicians":{"LM - Brooks Lawson":71,"LM - Fernando Cruz":65,"LM - Kelsey Githens":2,"Last Mile - Brooks Lawson":1,"Tech - Kelsey Githens":1},"avg_cost":775.15,"total_cost":53485.13,"cost_count":69,"avg_labor":0,"avg_parts":0,"median_comp_hrs":17.1,"avg_comp_hrs":51.3,"comp_time_count":125,"median_resp_hrs":3.6,"resp_count":91,"hold_reasons":{},"cancel_reasons":{"Duplicate":6,"Work no longer required":4,"Unit no longer on site":2,"Unit at third party workshop":1,"IT Issue":1}},"HCL2":{"label":"HCL2","total":164,"completed":133,"cancelled":18,"on_hold":1,"open":12,"status_counts":{"COMPLETED":133,"CANCELLED":18,"DISPATCH_ACCEPTED":5,"DISPATCHED":3,"AWAITING_ESTIMATE_APPROVAL":3,"ON_HOLD":1,"ASSIGNED":1},"priorities":{"MEDIUM":163,"LOW":1},"categories":{"PREVENTATIVE_MAINTENANCE":129,"MECHANICAL":30,"ELECTRICAL":3,"BODYWORK":2},"types":{"NON_SCHEDULED":160,"SCHEDULED":4},"workflows":{"REPAIR":40,"PM_A":34,"CHECK_AND_ADVISE":30,"PM_B":25,"DOT":22,"PM_DOT":6,"DOT_INSPECTION":5,"LIFT_GATE_PM":1},"technicians":{"LM NC - Justin Owens":52,"Macon, GA - Justin Owens":31,"Tech - Kelsey Githens":22,"FM - Eugene Fowler":16,"David Knight":9,"LM - Victor Wells":6,"LM - Eugene Fowler":4,"LM - Alexander Childs":4,"NC - Steven Knotts":3,"LM - Christopher Steele":2,"PMs ONLY - Todd Bradley":1},"avg_cost":920.45,"total_cost":58908.81,"cost_count":64,"avg_labor":0,"avg_parts":0,"median_comp_hrs":87.4,"avg_comp_hrs":126.6,"comp_time_count":133,"median_resp_hrs":19.6,"resp_count":41,"hold_reasons":{"Waiting for Diagnosis":1,"Part delay: waiting for delivery":1,"Additional Work Needed":1},"cancel_reasons":{"Duplicate":9,"Work no longer required":8,"IT Issue":1}},"HCT2":{"label":"HCT2","total":85,"completed":78,"cancelled":6,"on_hold":0,"open":1,"status_counts":{"COMPLETED":78,"CANCELLED":6,"ASSIGNED":1},"priorities":{"MEDIUM":84,"LOW":1},"categories":{"PREVENTATIVE_MAINTENANCE":37,"MECHANICAL":12,"BODYWORK":1},"types":{"NON_SCHEDULED":85},"workflows":{"CHECK_AND_ADVISE":40,"PM_B":16,"REPAIR":15,"PM_A":10,"DOT":4},"technicians":{"LM - Alexander Childs":44,"LM - Cletus Harvey":20,"FM - Eugene Fowler":16,"LM - Eugene Fowler":3},"avg_cost":985.11,"total_cost":40389.5,"cost_count":41,"avg_labor":0,"avg_parts":0,"median_comp_hrs":40.1,"avg_comp_hrs":62.4,"comp_time_count":78,"median_resp_hrs":13.4,"resp_count":44,"hold_reasons":{"Additional Work Needed":1},"cancel_reasons":{"Unit at third party workshop":2,"Unable to duplicate issue":2,"Work no longer required":1,"Duplicate":1}},"HDT3":{"label":"HDT3","total":389,"completed":351,"cancelled":34,"on_hold":0,"open":4,"status_counts":{"COMPLETED":351,"CANCELLED":34,"DISPATCH_ACCEPTED":3,"AWAITING_ESTIMATE_APPROVAL":1},"priorities":{"MEDIUM":334,"CRITICAL":52,"LOW":2,"HIGH":1},"categories":{"PREVENTATIVE_MAINTENANCE":67,"MECHANICAL":13,"BODYWORK":2,"ELECTRICAL":1},"types":{"NON_SCHEDULED":382,"SCHEDULED":7},"workflows":{"CHECK_AND_ADVISE":259,"PM_A":47,"REPAIR":46,"PM_B":16,"DOT":16,"PM_DOT":2},"technicians":{"LM - Terence Lucas":185,"LM - Thomas McRoberts":178,"IN - David Ross (Lead Tech)":6,"Last Mile - Thomas McRoberts":5,"LM - Richard Anderson Sr.":5,"LM - Victor Wells":5,"Last Mile - Terence Lucas":3,"Last Mile - Richard Anderson Sr.":1},"avg_cost":787.15,"total_cost":188128.06,"cost_count":239,"avg_labor":0,"avg_parts":0,"median_comp_hrs":48.3,"avg_comp_hrs":72.1,"comp_time_count":351,"median_resp_hrs":13.6,"resp_count":182,"hold_reasons":{"Part delay: waiting for delivery":1},"cancel_reasons":{"Duplicate":19,"Work no longer required":7,"Unit at dealer":4,"Unit no longer on site":2,"Unit at third party workshop":1,"IT Issue":1}},"HDY1":{"label":"HDY1","total":118,"completed":99,"cancelled":11,"on_hold":0,"open":8,"status_counts":{"COMPLETED":99,"CANCELLED":11,"DISPATCHED":8},"priorities":{"MEDIUM":116,"LOW":2},"categories":{"PREVENTATIVE_MAINTENANCE":75,"MECHANICAL":38,"ELECTRICAL":4},"types":{"NON_SCHEDULED":116,"SCHEDULED":2},"workflows":{"CHECK_AND_ADVISE":36,"PM_A":34,"REPAIR":21,"PM_B":14,"DOT":8,"PM_DOT":3,"AIR_FILTER":2},"technicians":{"LM - Timothy Merritt":45,"OH - Charles Burgess":29,"LM - Victor Wells":22,"LM - Richard Anderson Sr.":6,"FM - Eugene Fowler":5,"CORE - Robert Sutton":4,"Last Mile - Victor Wells":2,"OH - Randy Fisher":2,"LM - Fernando Cruz":1},"avg_cost":840.25,"total_cost":31089.36,"cost_count":37,"avg_labor":0,"avg_parts":0,"median_comp_hrs":45.0,"avg_comp_hrs":83.2,"comp_time_count":99,"median_resp_hrs":6.9,"resp_count":41,"hold_reasons":{"Additional Work Needed":2,"Waiting for Diagnosis":1},"cancel_reasons":{"Work no longer required":5,"Duplicate":5,"Unit no longer on site":1}},"HHO3":{"label":"HHO3","total":275,"completed":238,"cancelled":30,"on_hold":1,"open":6,"status_counts":{"COMPLETED":238,"CANCELLED":30,"AWAITING_ESTIMATE_APPROVAL":2,"DISPATCH_ACCEPTED":2,"ON_HOLD":1,"DISPATCHED":1,"ASSIGNED":1},"priorities":{"MEDIUM":267,"LOW":8},"categories":{"PREVENTATIVE_MAINTENANCE":47,"MECHANICAL":8,"BODYWORK":2,"ELECTRICAL":1},"types":{"NON_SCHEDULED":267,"SCHEDULED":8},"workflows":{"CHECK_AND_ADVISE":162,"REPAIR":32,"PM_B":29,"DOT":21,"PM_A":20,"DOT_INSPECTION":8,"PM_DOT":1},"technicians":{"LM - Evereth Salas":159,"LM - Lamont Henderson":70,"LM - Sabrina Finch":38,"HOU, TX - Omar Noriega":4,"CORE - Manuel Hidalgo":1},"avg_cost":628.42,"total_cost":88607.56,"cost_count":141,"avg_labor":0,"avg_parts":0,"median_comp_hrs":32.3,"avg_comp_hrs":77.6,"comp_time_count":238,"median_resp_hrs":7.1,"resp_count":108,"hold_reasons":{"Unable to access unit":1,"Part delay: waiting for delivery":1,"Parts Sourcing Delay":1,"Additional Work Needed":1},"cancel_reasons":{"Duplicate":16,"Work no longer required":8,"IT Issue":6,"Unable to source tools":1}},"HIN3":{"label":"HIN3","total":68,"completed":51,"cancelled":16,"on_hold":0,"open":1,"status_counts":{"COMPLETED":51,"CANCELLED":16,"DISPATCHED":1},"priorities":{"MEDIUM":67,"LOW":1},"categories":{"PREVENTATIVE_MAINTENANCE":21,"MECHANICAL":5,"ELECTRICAL":1,"BODYWORK":1},"types":{"NON_SCHEDULED":66,"SCHEDULED":2},"workflows":{"CHECK_AND_ADVISE":38,"REPAIR":9,"PM_A":8,"PM_B":8,"DOT":5},"technicians":{"LM - Victor Wells":50,"Last Mile - John Weaver":11,"IN - David Ross (Lead Tech)":3,"Last Mile - Victor Wells":1,"LM - Thomas McRoberts":1,"IN - Kevin Johnson":1},"avg_cost":948.47,"total_cost":32248.13,"cost_count":34,"avg_labor":0,"avg_parts":0,"median_comp_hrs":23.9,"avg_comp_hrs":70.7,"comp_time_count":51,"median_resp_hrs":7.0,"resp_count":28,"hold_reasons":{"Part delay: back ordered":1},"cancel_reasons":{"Work no longer required":9,"Duplicate":5,"IT Issue":1,"Unit at dealer":1}},"HLA2":{"label":"HLA2","total":411,"completed":370,"cancelled":34,"on_hold":0,"open":7,"status_counts":{"COMPLETED":370,"CANCELLED":34,"DISPATCH_ACCEPTED":6,"ASSIGNED":1},"priorities":{"MEDIUM":399,"LOW":12},"categories":{"PREVENTATIVE_MAINTENANCE":186,"MECHANICAL":89,"ELECTRICAL":16,"BODYWORK":13,"STRUCTURAL":1},"types":{"NON_SCHEDULED":397,"SCHEDULED":14},"workflows":{"CHECK_AND_ADVISE":185,"PM_A":81,"REPAIR":80,"PM_B":40,"CTC":11,"DOT":9},"technicians":{"LM - Jose Madrigal":203,"LM - Justin Forte":113,"Fresno - Nicholas Darter":36,"LM - Denzel Alexander":19,"Fresno - David Knight":11,"LM - Dale Garcia":9,"Enrique Gomez-Navarro":6,"Marcos Valdivia":6,"Fresno - Pablo Alvarenga \ud83d\udcbb":4,"LM - Kelsey Githens":1,"Stockton - Jesse Ruckman":1},"avg_cost":657.62,"total_cost":105877.25,"cost_count":161,"avg_labor":0,"avg_parts":0,"median_comp_hrs":24.6,"avg_comp_hrs":66.7,"comp_time_count":370,"median_resp_hrs":10.4,"resp_count":159,"hold_reasons":{"Parts Sourcing Delay":2,"Additional Work Needed":1},"cancel_reasons":{"Duplicate":25,"Work no longer required":9}},"HMK4":{"label":"HMK4","total":121,"completed":113,"cancelled":7,"on_hold":0,"open":1,"status_counts":{"COMPLETED":113,"CANCELLED":7,"DISPATCHED":1},"priorities":{"MEDIUM":121},"categories":{"PREVENTATIVE_MAINTENANCE":74,"MECHANICAL":22,"ELECTRICAL":21,"BODYWORK":3},"types":{"NON_SCHEDULED":120,"SCHEDULED":1},"workflows":{"PM_A":33,"REPAIR":30,"PM_B":19,"CHECK_AND_ADVISE":19,"DOT":17,"BRAKE_SYSTEM_FLUSH":2,"SERPENTINE_BELT":1},"technicians":{"LM - Alejandro Fernandez":90,"LM - William Low":29},"avg_cost":555.32,"total_cost":23323.65,"cost_count":42,"avg_labor":0,"avg_parts":0,"median_comp_hrs":20.4,"avg_comp_hrs":54.7,"comp_time_count":113,"median_resp_hrs":13.7,"resp_count":63,"hold_reasons":{"Additional Work Needed":1,"Waiting for Diagnosis":1},"cancel_reasons":{"Duplicate":6,"Work no longer required":1}},"HMS2":{"label":"HMS2","total":160,"completed":146,"cancelled":11,"on_hold":0,"open":3,"status_counts":{"COMPLETED":146,"CANCELLED":11,"AWAITING_ESTIMATE_APPROVAL":1,"DISPATCH_ACCEPTED":1,"IN_REPAIR":1},"priorities":{"MEDIUM":159,"LOW":1},"categories":{"PREVENTATIVE_MAINTENANCE":64,"MECHANICAL":10},"types":{"NON_SCHEDULED":158,"SCHEDULED":2},"workflows":{"CHECK_AND_ADVISE":79,"REPAIR":31,"PM_B":24,"PM_A":15,"DOT":8,"PM_DOT":2,"DOT_INSPECTION":1},"technicians":{"Last Mile - Joseph Defreeuw":43,"FM - Eugene Fowler":42,"LM - Michael Gorman":21,"Last Mile - Brad Butti":17,"MN - Patrick Roberts (MSP7)":9,"MN - Daniel Freeman (MSP8/MSP1 Mon,Tue/All PM-B)":8,"LM - Kelsey Githens":5,"LM - Richard Anderson Sr.":4,"LM - Alejandro Fernandez":4,"LM - Eugene Fowler":2,"IN - David Ross (Lead Tech)":1},"avg_cost":585.84,"total_cost":49210.21,"cost_count":84,"avg_labor":0,"avg_parts":0,"median_comp_hrs":30.4,"avg_comp_hrs":57.7,"comp_time_count":146,"median_resp_hrs":8.7,"resp_count":72,"hold_reasons":{"Parts Sourcing Delay":1,"Additional Work Needed":1},"cancel_reasons":{"Duplicate":6,"Work no longer required":4,"Unit no longer on site":1}},"HPD1":{"label":"HPD1","total":13,"completed":8,"cancelled":5,"on_hold":0,"open":0,"status_counts":{"COMPLETED":8,"CANCELLED":5},"priorities":{"MEDIUM":13},"categories":{"MECHANICAL":3,"BODYWORK":1,"PREVENTATIVE_MAINTENANCE":1},"types":{"NON_SCHEDULED":13},"workflows":{"CHECK_AND_ADVISE":10,"PM_B":1,"REPAIR":1,"DOT":1},"technicians":{"Last Mile - Noussayr Marzouki":5,"CORE - Michael Ward":5},"avg_cost":691.02,"total_cost":1382.04,"cost_count":2,"avg_labor":0,"avg_parts":0,"median_comp_hrs":62.0,"avg_comp_hrs":69.0,"comp_time_count":8,"median_resp_hrs":12.6,"resp_count":7,"hold_reasons":{},"cancel_reasons":{"Work no longer required":2,"Completed in legacy platform":1,"IT Issue":1,"Duplicate":1}},"HSL1":{"label":"HSL1","total":134,"completed":113,"cancelled":20,"on_hold":0,"open":1,"status_counts":{"COMPLETED":113,"CANCELLED":20,"DISPATCHED":1},"priorities":{"MEDIUM":134},"categories":{"PREVENTATIVE_MAINTENANCE":41,"MECHANICAL":8,"BODYWORK":4},"types":{"NON_SCHEDULED":133,"SCHEDULED":1},"workflows":{"CHECK_AND_ADVISE":78,"PM_A":18,"REPAIR":18,"PM_B":9,"DOT":8,"OIL_CHANGE":1},"technicians":{"LM - Marcos Tun":119,"LM - Kelsey Githens":5,"SLC - Dakota Theademan (SLC2)":3,"Last Mile- Marcos Tun":3,"SLC - Torrey Watson ( All sites)":1,"SLC -PM Only Austin Harwood":1},"avg_cost":648.35,"total_cost":32417.28,"cost_count":50,"avg_labor":0,"avg_parts":0,"median_comp_hrs":27.6,"avg_comp_hrs":51.4,"comp_time_count":113,"median_resp_hrs":7.7,"resp_count":82,"hold_reasons":{"Parts Sourcing Delay":1,"Additional Work Needed":1},"cancel_reasons":{"Work no longer required":9,"Duplicate":9,"Unit no longer on site":2}},"HTP2":{"label":"HTP2","total":336,"completed":297,"cancelled":38,"on_hold":0,"open":1,"status_counts":{"COMPLETED":297,"CANCELLED":38,"AWAITING_ESTIMATE_APPROVAL":1},"priorities":{"MEDIUM":321,"LOW":15},"categories":{"PREVENTATIVE_MAINTENANCE":95,"MECHANICAL":36,"ELECTRICAL":12,"BODYWORK":5},"types":{"NON_SCHEDULED":335,"SCHEDULED":1},"workflows":{"CHECK_AND_ADVISE":214,"REPAIR":50,"PM_A":33,"PM_B":23,"DOT":14},"technicians":{"LM - Jett Bukovac":167,"LM - Hector Brito":116,"LM - Eugene Fowler":19,"Last Mile - Hector Brito":9,"FL - Daniel De Jesus":9,"LM - Kelsey Githens":7,"Last Mile - Kelsey Githens":3},"avg_cost":728.62,"total_cost":125322.96,"cost_count":172,"avg_labor":0,"avg_parts":0,"median_comp_hrs":50.8,"avg_comp_hrs":91.7,"comp_time_count":297,"median_resp_hrs":8.9,"resp_count":131,"hold_reasons":{"Additional Work Needed":3,"Waiting on customer: parts to be supplied":1,"Unable to access unit":1,"Parts Sourcing Delay":1,"Waiting for Diagnosis":1},"cancel_reasons":{"Duplicate":9,"Work no longer required":9,"Unit at dealer":6,"IT Issue":5,"Unit no longer on site":5,"Unable to source parts":3,"Unable to source tools":1}}}};
var MOM={"months":["2025-10","2025-11","2025-12","2026-01","2026-02"],"mom":{"HMS2":{"2025-10":{"t":56,"c":54,"x":2,"h":0,"o":0,"avgCost":181.26,"totCost":7250.58,"medComp":15.2,"avgComp":34.9,"medResp":8.7},"2025-11":{"t":33,"c":33,"x":0,"h":0,"o":0,"avgCost":1465.78,"totCost":17589.31,"medComp":58.6,"avgComp":125.7,"medResp":12.0},"2025-12":{"t":18,"c":18,"x":0,"h":0,"o":0,"avgCost":636.44,"totCost":6364.45,"medComp":29.3,"avgComp":43.2,"medResp":5.0},"2026-01":{"t":38,"c":31,"x":7,"h":0,"o":0,"avgCost":891.06,"totCost":16039.04,"medComp":34.8,"avgComp":38.5,"medResp":5.2},"2026-02":{"t":15,"c":10,"x":2,"h":0,"o":3,"avgCost":491.71,"totCost":1966.84,"medComp":43.5,"avgComp":41.3,"medResp":15.1}},"OVERALL":{"2025-10":{"t":250,"c":215,"x":35,"h":0,"o":0,"avgCost":482.48,"totCost":79609.56,"medComp":45.1,"avgComp":99.4,"medResp":12.0},"2025-11":{"t":339,"c":276,"x":63,"h":0,"o":0,"avgCost":907.54,"totCost":122517.61,"medComp":75.4,"avgComp":143.0,"medResp":16.3},"2025-12":{"t":565,"c":504,"x":61,"h":0,"o":0,"avgCost":748.34,"totCost":172117.24,"medComp":30.4,"avgComp":62.5,"medResp":8.0},"2026-01":{"t":674,"c":629,"x":41,"h":1,"o":3,"avgCost":753.94,"totCost":229196.27,"medComp":30.1,"avgComp":57.7,"medResp":9.3},"2026-02":{"t":586,"c":498,"x":44,"h":1,"o":43,"avgCost":751.49,"totCost":226949.26,"medComp":26.6,"avgComp":56.2,"medResp":8.4}},"HDT3":{"2025-10":{"t":67,"c":56,"x":11,"h":0,"o":0,"avgCost":599.12,"totCost":26361.48,"medComp":61.8,"avgComp":102.5,"medResp":22.2},"2025-11":{"t":45,"c":39,"x":6,"h":0,"o":0,"avgCost":812.84,"totCost":22759.64,"medComp":65.2,"avgComp":91.5,"medResp":18.8},"2025-12":{"t":78,"c":71,"x":7,"h":0,"o":0,"avgCost":706.14,"totCost":33188.74,"medComp":32.2,"avgComp":54.8,"medResp":13.6},"2026-01":{"t":114,"c":111,"x":3,"h":0,"o":0,"avgCost":843.55,"totCost":51456.3,"medComp":38.4,"avgComp":68.8,"medResp":10.3},"2026-02":{"t":85,"c":74,"x":7,"h":0,"o":4,"avgCost":921.39,"totCost":54361.9,"medComp":36.6,"avgComp":60.4,"medResp":8.5}},"HIN3":{"2025-10":{"t":20,"c":15,"x":5,"h":0,"o":0,"avgCost":608.79,"totCost":8523.12,"medComp":14.6,"avgComp":57.4,"medResp":7.0},"2025-11":{"t":12,"c":7,"x":5,"h":0,"o":0,"avgCost":938.51,"totCost":3754.02,"medComp":97.9,"avgComp":157.0,"medResp":0},"2025-12":{"t":16,"c":15,"x":1,"h":0,"o":0,"avgCost":840.95,"totCost":5886.65,"medComp":52.5,"avgComp":67.4,"medResp":17.5},"2026-01":{"t":9,"c":8,"x":1,"h":0,"o":0,"avgCost":606.64,"totCost":1819.91,"medComp":11.2,"avgComp":22.9,"medResp":9.9},"2026-02":{"t":11,"c":6,"x":4,"h":0,"o":1,"avgCost":2044.07,"totCost":12264.43,"medComp":7.0,"avgComp":75.5,"medResp":4.4}},"HTP2":{"2025-10":{"t":60,"c":55,"x":5,"h":0,"o":0,"avgCost":534.05,"totCost":24566.32,"medComp":143.2,"avgComp":165.3,"medResp":44.5},"2025-11":{"t":73,"c":54,"x":19,"h":0,"o":0,"avgCost":1056.25,"totCost":32743.61,"medComp":94.8,"avgComp":115.3,"medResp":22.3},"2025-12":{"t":94,"c":86,"x":8,"h":0,"o":0,"avgCost":787.28,"totCost":30703.98,"medComp":47.6,"avgComp":78.3,"medResp":8.0},"2026-01":{"t":53,"c":49,"x":4,"h":0,"o":0,"avgCost":874.72,"totCost":19243.76,"medComp":28.1,"avgComp":45.5,"medResp":3.8},"2026-02":{"t":56,"c":53,"x":2,"h":0,"o":1,"avgCost":531.33,"totCost":18065.29,"medComp":26.5,"avgComp":55.8,"medResp":2.2}},"HSL1":{"2025-10":{"t":20,"c":15,"x":5,"h":0,"o":0,"avgCost":703.53,"totCost":6331.76,"medComp":84.9,"avgComp":106.4,"medResp":16.5},"2025-11":{"t":29,"c":20,"x":9,"h":0,"o":0,"avgCost":613.88,"totCost":4911.06,"medComp":46.2,"avgComp":61.7,"medResp":12.1},"2025-12":{"t":36,"c":33,"x":3,"h":0,"o":0,"avgCost":604.5,"totCost":7253.95,"medComp":8.3,"avgComp":31.1,"medResp":5.5},"2026-01":{"t":21,"c":21,"x":0,"h":0,"o":0,"avgCost":880.75,"totCost":7046.03,"medComp":11.9,"avgComp":40.1,"medResp":7.9},"2026-02":{"t":28,"c":24,"x":3,"h":0,"o":1,"avgCost":528.81,"totCost":6874.48,"medComp":30.5,"avgComp":46.2,"medResp":9.2}},"HPD1":{"2025-10":{"t":4,"c":1,"x":3,"h":0,"o":0,"avgCost":1344.49,"totCost":1344.49,"medComp":142.7,"avgComp":142.7,"medResp":3.9},"2025-11":{"t":5,"c":4,"x":1,"h":0,"o":0,"avgCost":37.55,"totCost":37.55,"medComp":78.4,"avgComp":75.4,"medResp":23.8},"2025-12":{"t":3,"c":2,"x":1,"h":0,"o":0,"avgCost":0,"totCost":0,"medComp":27.5,"avgComp":22.7,"medResp":12.6},"2026-01":{"t":1,"c":1,"x":0,"h":0,"o":0,"avgCost":0,"totCost":0,"medComp":62.0,"avgComp":62.0,"medResp":35.4},"2026-02":{"t":0,"c":0,"x":0,"h":0,"o":0,"avgCost":0,"medComp":0,"avgComp":0,"medResp":0,"totCost":0}},"HCT2":{"2025-10":{"t":9,"c":8,"x":1,"h":0,"o":0,"avgCost":322.33,"totCost":1611.63,"medComp":51.1,"avgComp":72.3,"medResp":17.9},"2025-11":{"t":18,"c":18,"x":0,"h":0,"o":0,"avgCost":551.02,"totCost":6061.18,"medComp":54.5,"avgComp":84.5,"medResp":16.1},"2025-12":{"t":27,"c":24,"x":3,"h":0,"o":0,"avgCost":1264.07,"totCost":15168.88,"medComp":39.2,"avgComp":47.3,"medResp":6.2},"2026-01":{"t":23,"c":21,"x":2,"h":0,"o":0,"avgCost":1531.98,"totCost":12255.81,"medComp":38.1,"avgComp":70.1,"medResp":23.5},"2026-02":{"t":8,"c":7,"x":0,"h":0,"o":1,"avgCost":1058.4,"totCost":5292.0,"medComp":24.2,"avgComp":22.6,"medResp":13.4}},"HAU1":{"2025-10":{"t":10,"c":8,"x":2,"h":0,"o":0,"avgCost":692.56,"totCost":3462.8,"medComp":92.5,"avgComp":164.4,"medResp":1.5},"2025-11":{"t":14,"c":9,"x":5,"h":0,"o":0,"avgCost":435.15,"totCost":2610.92,"medComp":118.5,"avgComp":167.0,"medResp":3.9},"2025-12":{"t":28,"c":25,"x":3,"h":0,"o":0,"avgCost":540.13,"totCost":6481.54,"medComp":21.9,"avgComp":34.0,"medResp":2.4},"2026-01":{"t":45,"c":41,"x":4,"h":0,"o":0,"avgCost":1238.61,"totCost":29726.61,"medComp":25.6,"avgComp":51.2,"medResp":4.9},"2026-02":{"t":43,"c":42,"x":0,"h":0,"o":1,"avgCost":509.24,"totCost":11203.27,"medComp":9.1,"avgComp":15.5,"medResp":5.2}},"HDY1":{"2025-10":{"t":4,"c":3,"x":1,"h":0,"o":0,"avgCost":157.39,"totCost":157.39,"medComp":22.6,"avgComp":56.5,"medResp":0.1},"2025-11":{"t":11,"c":8,"x":3,"h":0,"o":0,"avgCost":1120.77,"totCost":5603.85,"medComp":167.9,"avgComp":209.0,"medResp":18.5},"2025-12":{"t":41,"c":37,"x":4,"h":0,"o":0,"avgCost":1211.76,"totCost":9694.11,"medComp":65.3,"avgComp":96.9,"medResp":2.0},"2026-01":{"t":34,"c":32,"x":2,"h":0,"o":0,"avgCost":814.24,"totCost":10585.06,"medComp":50.3,"avgComp":71.7,"medResp":16.5},"2026-02":{"t":28,"c":19,"x":1,"h":0,"o":8,"avgCost":504.89,"totCost":5048.95,"medComp":10.8,"avgComp":27.3,"medResp":8.9}},"HHO3":{"2025-10":{"t":0,"c":0,"x":0,"h":0,"o":0,"avgCost":0,"medComp":0,"avgComp":0,"medResp":0,"totCost":0},"2025-11":{"t":58,"c":49,"x":9,"h":0,"o":0,"avgCost":1022.22,"totCost":20444.49,"medComp":103.2,"avgComp":178.3,"medResp":13.1},"2025-12":{"t":78,"c":66,"x":12,"h":0,"o":0,"avgCost":684.09,"totCost":24627.12,"medComp":28.4,"avgComp":57.4,"medResp":6.2},"2026-01":{"t":76,"c":74,"x":2,"h":0,"o":0,"avgCost":405.19,"totCost":19854.17,"medComp":26.1,"avgComp":40.8,"medResp":6.7},"2026-02":{"t":63,"c":49,"x":7,"h":1,"o":6,"avgCost":657.83,"totCost":23681.78,"medComp":33.8,"avgComp":59.7,"medResp":6.0}},"HLA2":{"2025-10":{"t":0,"c":0,"x":0,"h":0,"o":0,"avgCost":0,"medComp":0,"avgComp":0,"medResp":0,"totCost":0},"2025-11":{"t":41,"c":35,"x":6,"h":0,"o":0,"avgCost":666.89,"totCost":6001.98,"medComp":248.4,"avgComp":270.5,"medResp":14.5},"2025-12":{"t":91,"c":80,"x":11,"h":0,"o":0,"avgCost":767.46,"totCost":27628.55,"medComp":30.2,"avgComp":69.2,"medResp":11.9},"2026-01":{"t":133,"c":129,"x":4,"h":0,"o":0,"avgCost":634.34,"totCost":26642.46,"medComp":17.4,"avgComp":30.4,"medResp":9.8},"2026-02":{"t":146,"c":126,"x":13,"h":0,"o":7,"avgCost":616.27,"totCost":45604.26,"medComp":22.5,"avgComp":45.7,"medResp":10.4}},"HMK4":{"2025-10":{"t":0,"c":0,"x":0,"h":0,"o":0,"avgCost":0,"medComp":0,"avgComp":0,"medResp":0,"totCost":0},"2025-11":{"t":0,"c":0,"x":0,"h":0,"o":0,"avgCost":0,"medComp":0,"avgComp":0,"medResp":0,"totCost":0},"2025-12":{"t":44,"c":42,"x":2,"h":0,"o":0,"avgCost":443.84,"totCost":3994.6,"medComp":12.6,"avgComp":45.9,"medResp":9.1},"2026-01":{"t":52,"c":48,"x":3,"h":0,"o":1,"avgCost":629.17,"totCost":14470.99,"medComp":20.4,"avgComp":56.5,"medResp":16.1},"2026-02":{"t":25,"c":23,"x":2,"h":0,"o":0,"avgCost":485.81,"totCost":4858.06,"medComp":46.6,"avgComp":67.0,"medResp":18.5}},"HCL2":{"2025-10":{"t":0,"c":0,"x":0,"h":0,"o":0,"avgCost":0,"medComp":0,"avgComp":0,"medResp":0,"totCost":0},"2025-11":{"t":0,"c":0,"x":0,"h":0,"o":0,"avgCost":0,"medComp":0,"avgComp":0,"medResp":0,"totCost":0},"2025-12":{"t":11,"c":5,"x":6,"h":0,"o":0,"avgCost":562.34,"totCost":1124.67,"medComp":214.5,"avgComp":239.6,"medResp":0},"2026-01":{"t":75,"c":63,"x":9,"h":1,"o":2,"avgCost":607.76,"totCost":20056.13,"medComp":115.1,"avgComp":136.9,"medResp":22.4},"2026-02":{"t":78,"c":65,"x":3,"h":0,"o":10,"avgCost":1300.97,"totCost":37728.01,"medComp":56.1,"avgComp":108.0,"medResp":16.0}}}};
var ADOPTION={HTP2:{station:'HTP2',location:'Gibsonton, FL',kooner:89,leaked:18,adoption:83.2},HSL1:{station:'HSL1',location:'Salt Lake City, UT',kooner:30,leaked:2,adoption:93.8},HHO3:{station:'HHO3',location:'Porter, TX',kooner:96,leaked:24,adoption:80.0},HDY1:{station:'HDY1',location:'Clayton, OH',kooner:54,leaked:13,adoption:80.6},HCT2:{station:'HCT2',location:'Chattanooga, TN',kooner:24,leaked:4,adoption:85.7},HCL2:{station:'HCL2',location:'Charlotte, NC',kooner:70,leaked:62,adoption:53.0},HDT3:{station:'HDT3',location:'Romulus, MI',kooner:152,leaked:141,adoption:51.9},HMS2:{station:'HMS2',location:'Lakeville, MN',kooner:37,leaked:33,adoption:52.9},HIN3:{station:'HIN3',location:'South Bend, IN',kooner:16,leaked:20,adoption:44.4},HLA2:{station:'HLA2',location:'Santa Clarita, CA',kooner:189,leaked:250,adoption:43.1},HAU1:{station:'HAU1',location:'Austin, TX',kooner:53,leaked:78,adoption:40.5},HPD1:{station:'HPD1',location:'Portland, OR',kooner:1,leaked:34,adoption:2.9}};
var SENTIMENT=[{dsp:"ALAB",station:"HDT3",responses:1,sat:1.0,time:1.0,qual:1.0,avg:1.0},{dsp:"ARMA",station:"HLA2",responses:5,sat:2.6,time:2.6,qual:2.6,avg:2.6},{dsp:"ORMP",station:"HTP2",responses:2,sat:2.0,time:2.0,qual:3.0,avg:2.3},{dsp:"MAEP",station:"HIN3",responses:1,sat:2.0,time:2.0,qual:3.0,avg:2.3},{dsp:"SFRM",station:"HDT3",responses:3,sat:3.3,time:3.0,qual:3.0,avg:3.1},{dsp:"PRLC",station:"HSL1",responses:1,sat:4.0,time:5.0,qual:3.0,avg:4.0},{dsp:"D4DS",station:"HCL2",responses:1,sat:5.0,time:5.0,qual:5.0,avg:5.0}];
var FEEDBACK=[{date:"Feb 10",dsp:"SFRM",station:"HDT3",sat:4,time:4,qual:4,issue:"Unit 2974 pending diagnostics for a few days",suggestion:"More availability for weekend issues, over the road calls."},{date:"Feb 9",dsp:"ORMP",station:"HTP2",sat:2,time:2,qual:4,issue:"Multiple WOs not looked at since 2/4. Helpful contact laid off.",suggestion:""},{date:"Feb 9",dsp:"ARMA",station:"HLA2",sat:5,time:5,qual:5,issue:"",suggestion:"Jose Madrigal is GREAT! Very professional and attentive."},{date:"Feb 2",dsp:"SFRM",station:"HDT3",sat:3,time:3,qual:3,issue:"",suggestion:"Need 2 day techs. Better communication."},{date:"Jan 26",dsp:"ALAB",station:"HDT3",sat:1,time:1,qual:1,issue:"Lack of timely repairs. Same issue after ungrounding.",suggestion:"Timely repairs needed."},{date:"Jan 12",dsp:"D4DS",station:"HCL2",sat:5,time:5,qual:5,issue:"",suggestion:"Supervisor got more vehicles running in one evening than any mechanic in 5 years."},{date:"Jan 6",dsp:"ORMP",station:"HTP2",sat:2,time:2,qual:2,issue:"No paperwork after 7 days. Brakes still bad.",suggestion:"Need schedule access."},{date:"Jan 5",dsp:"ARMA",station:"HLA2",sat:1,time:1,qual:1,issue:"No work orders submitted.",suggestion:"Better communication."}];

var cur='HDY1',names=Object.keys(WO.stations).sort(),chartInstances=[];
var MLABELS=MOM.months.map(function(m){var parts=m.split('-');var mi=parseInt(parts[1]);var mNames=['','Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];return mNames[mi]+" '"+parts[0].slice(2)});

function gm(k){return k==='OVERALL'?WO.overall:WO.stations[k]}
function p2(n,d){return d?(n/d*100).toFixed(1):'0.0'}
function cc(v,hi){if(hi!==false)return v>=85?'gr':v>=70?'ye':'re';return v<=5?'gr':v<=12?'ye':'re'}
function topN(o,n){return Object.entries(o).sort(function(a,b){return b[1]-a[1]}).slice(0,n||5)}
function scv(v){return v>=4?'gr':v>=3?'ye':v>=2?'or':'re'}
function scoreColor(v){return v>=4?'var(--gn)':v>=3?'var(--yl)':v>=2?'var(--or)':'var(--rd)'}
function kpi(label,val,colorCls,borderCls,sub){return'<div class="kp '+(borderCls||'')+'"><div class="lb">'+label+'</div><div class="vl '+(colorCls||'')+'">'+val+'</div>'+(sub?'<div class="sb">'+sub+'</div>':'')+'</div>'}
function deltaTag(curr,prev,inv){if(!prev||!curr)return'<span class="delta nt">—</span>';var d=curr-prev,pct=prev?(d/prev*100).toFixed(0):'';var up=inv?d<0:d>0;if(Math.abs(d)<0.01)return'<span class="delta nt">0%</span>';return'<span class="delta '+(up?'up':'dn')+'">'+(d>0?'+':'')+pct+'%</span>'}

function getMoM(stn){var d=MOM.mom[stn];if(!d)return null;var out=[];MOM.months.forEach(function(m){out.push(d[m]||{t:0,c:0,x:0,h:0,o:0,avgCost:0,medComp:0,avgComp:0,medResp:0,totCost:0})});return out}

function buildMoMSection(stn){
  var md=getMoM(stn);if(!md)return'';
  var last=md[md.length-1],prev=md[md.length-2];
  var compLast=last.t?last.c/last.t*100:0,compPrev=prev.t?prev.c/prev.t*100:0;
  var uid=stn.replace(/[^a-zA-Z0-9]/g,'');
  var h='<div class="mom-box"><div class="mom-title">&#x1f4c8; Month-over-Month Trends</div>';
  h+='<div class="kg" style="margin-bottom:16px">';
  h+='<div class="kp or"><div class="lb">Feb Work Orders</div><div class="vl">'+last.t+' '+deltaTag(last.t,prev.t)+'</div><div class="sb">Jan: '+prev.t+'</div></div>';
  h+='<div class="kp '+(compLast>=85?'gr':compLast>=70?'ye':'re')+'"><div class="lb">Feb Completion</div><div class="vl '+cc(compLast)+'">'+compLast.toFixed(1)+'% '+deltaTag(compLast,compPrev)+'</div><div class="sb">Jan: '+compPrev.toFixed(1)+'%</div></div>';
  h+='<div class="kp '+(last.medComp<36?'gr':last.medComp<72?'ye':'re')+'"><div class="lb">Feb Median Completion</div><div class="vl">'+last.medComp+'h '+deltaTag(last.medComp,prev.medComp,true)+'</div><div class="sb">Jan: '+prev.medComp+'h</div></div>';
  h+='<div class="kp '+(last.medResp<12?'gr':last.medResp<24?'ye':'re')+'"><div class="lb">Feb Median Response</div><div class="vl">'+last.medResp+'h '+deltaTag(last.medResp,prev.medResp,true)+'</div><div class="sb">Jan: '+prev.medResp+'h</div></div>';
  h+='</div>';
  h+='<div class="chart-row"><div class="chart-card"><div class="cc-title">Work Order Volume &amp; Completion Rate</div><canvas id="momVol_'+uid+'"></canvas></div>';
  h+='<div class="chart-card"><div class="cc-title">Median Completion &amp; Response Time</div><canvas id="momTime_'+uid+'"></canvas></div></div>';
  h+='<div class="tw scr"><table><thead><tr><th>Month</th><th>Work Orders</th><th>Completion %</th><th>Cancel %</th><th>Med Completion</th><th>Med Response</th></tr></thead><tbody>';
  MOM.months.forEach(function(m,i){var d2=md[i];if(!d2.t){h+='<tr><td>'+MLABELS[i]+'</td><td colspan="5" style="color:var(--dm)">No data</td></tr>';return}var cpct=d2.t?d2.c/d2.t*100:0;var xpct=d2.t?d2.x/d2.t*100:0;h+='<tr><td><strong>'+MLABELS[i]+'</strong></td><td>'+d2.t+'</td><td><span class="bg '+cc(cpct)+'">'+cpct.toFixed(1)+'%</span></td><td><span class="bg '+cc(xpct,false)+'">'+xpct.toFixed(1)+'%</span></td><td>'+d2.medComp+'h</td><td>'+d2.medResp+'h</td></tr>'});
  h+='</tbody></table></div></div>';return h;
}

function buildSentimentSection(stn){
  var sents=stn==='OVERALL'?SENTIMENT:SENTIMENT.filter(function(s){return s.station===stn});
  var fb=stn==='OVERALL'?FEEDBACK:FEEDBACK.filter(function(f){return f.station===stn});
  var adopt=stn==='OVERALL'?(function(){var tk=0,tl=0;Object.values(ADOPTION).forEach(function(a){tk+=a.kooner;tl+=a.leaked});return{kooner:tk,leaked:tl,adoption:parseFloat((tk/(tk+tl)*100).toFixed(1))}})():ADOPTION[stn]||null;
  var h='<div class="sent-box"><div class="sent-title">&#x1f4ac; Sentiment &amp; Adoption</div>';
  if(adopt){var acolor=adopt.adoption>=85?'var(--gn)':adopt.adoption>=70?'var(--yl)':'var(--rd)';var abg=adopt.adoption>=85?'#15803d':adopt.adoption>=70?'#a16207':'#b91c1c';h+='<div class="adopt-bar"><div class="ab-lbl">Adoption</div><div class="ab-track"><div class="ab-fill" style="width:'+adopt.adoption+'%;background:'+abg+'">'+adopt.adoption+'%</div><div class="ab-target" title="85% Target"></div></div><div class="ab-val" style="color:'+acolor+'">'+adopt.adoption+'%</div></div><div style="display:flex;gap:16px;margin-bottom:14px;font-size:11px;color:var(--mu)"><span>Kooner: <strong style="color:var(--gn)">'+adopt.kooner+'</strong></span><span>Leaked: <strong style="color:var(--rd)">'+adopt.leaked+'</strong></span><span>Target: <strong style="color:var(--yl)">85%</strong></span></div>'}else{h+='<div style="margin-bottom:14px;font-size:11px;color:var(--dm);font-style:italic">No adoption data for this station</div>'}
  if(sents.length>0){var tr2=0,aS=0,aT=0,aQ=0,aA=0;sents.forEach(function(s){tr2+=s.responses;aS+=s.sat*s.responses;aT+=s.time*s.responses;aQ+=s.qual*s.responses;aA+=s.avg*s.responses});if(tr2){aS/=tr2;aT/=tr2;aQ/=tr2;aA/=tr2}h+='<div class="sent-kpis"><div class="sent-kpi"><div class="sk-lb">Responses</div><div class="sk-vl">'+tr2+'</div></div><div class="sent-kpi"><div class="sk-lb">Satisfaction</div><div class="sk-vl '+scv(aS)+'">'+aS.toFixed(1)+'</div></div><div class="sent-kpi"><div class="sk-lb">Timeliness</div><div class="sk-vl '+scv(aT)+'">'+aT.toFixed(1)+'</div></div><div class="sent-kpi"><div class="sk-lb">Quality</div><div class="sk-vl '+scv(aQ)+'">'+aQ.toFixed(1)+'</div></div><div class="sent-kpi"><div class="sk-lb">Overall</div><div class="sk-vl '+scv(aA)+'">'+aA.toFixed(1)+'/5</div></div></div>';h+='<div class="tw"><table><thead><tr><th>DSP</th><th>Station</th><th>Resp</th><th>Sat</th><th>Time</th><th>Qual</th><th>Avg</th></tr></thead><tbody>';sents.slice().sort(function(a,b){return a.avg-b.avg}).forEach(function(s){h+='<tr><td><strong>'+s.dsp+'</strong></td><td>'+s.station+'</td><td>'+s.responses+'</td><td><span class="bg '+scv(s.sat)+'">'+s.sat.toFixed(1)+'</span></td><td><span class="bg '+scv(s.time)+'">'+s.time.toFixed(1)+'</span></td><td><span class="bg '+scv(s.qual)+'">'+s.qual.toFixed(1)+'</span></td><td><span class="bg '+scv(s.avg)+'">'+s.avg.toFixed(1)+'</span></td></tr>'});h+='</tbody></table></div>'}else{h+='<div class="no-data">No DSP sentiment survey data for this station</div>'}
  if(fb.length>0){h+='<div class="sc sent">Recent DSP Feedback</div>';fb.forEach(function(f){h+='<div class="fb-card"><div class="fb-hdr"><div><span class="fb-dsp">'+f.dsp+'</span> <span class="fb-date">'+f.date+(stn==='OVERALL'?' &middot; '+f.station:'')+'</span></div><div class="fb-scores"><span>S:<strong style="color:'+scoreColor(f.sat)+'">'+f.sat+'</strong></span><span>T:<strong style="color:'+scoreColor(f.time)+'">'+f.time+'</strong></span><span>Q:<strong style="color:'+scoreColor(f.qual)+'">'+f.qual+'</strong></span></div></div>';if(f.issue)h+='<div class="fb-txt issue">'+f.issue+'</div>';if(f.suggestion)h+='<div class="fb-txt pos">'+f.suggestion+'</div>';h+='</div>'})}
  h+='</div>';return h;
}

function renderCharts(stn){
  chartInstances.forEach(function(c){c.destroy()});chartInstances=[];
  var md=getMoM(stn);if(!md)return;
  var uid=stn.replace(/[^a-zA-Z0-9]/g,'');
  var gridColor='rgba(0,0,0,.06)',tickColor='#94a3b8';
  Chart.defaults.font.family='DM Sans';
  var base={responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:'#64748b',font:{size:10}},position:'top'}},animation:{duration:500}};
  var el1=document.getElementById('momVol_'+uid);
  if(el1){chartInstances.push(new Chart(el1,{type:'bar',data:{labels:MLABELS,datasets:[{type:'bar',label:'WO Volume',data:md.map(function(d){return d.t}),backgroundColor:'rgba(79,95,237,0.5)',borderRadius:5,yAxisID:'y',order:2},{type:'line',label:'Completion %',data:md.map(function(d){return d.t?(d.c/d.t*100):0}),borderColor:'#16a34a',backgroundColor:'rgba(22,163,74,0.08)',tension:.35,pointRadius:5,pointBackgroundColor:'#16a34a',fill:true,yAxisID:'y1',order:1}]},options:Object.assign({},base,{scales:{y:{position:'left',grid:{color:gridColor},ticks:{color:tickColor}},y1:{position:'right',min:0,max:100,grid:{display:false},ticks:{color:'#16a34a',callback:function(v){return v+'%'}}},x:{grid:{display:false},ticks:{color:tickColor}}}})}))}
  var el2=document.getElementById('momTime_'+uid);
  if(el2){chartInstances.push(new Chart(el2,{type:'line',data:{labels:MLABELS,datasets:[{label:'Med Completion (h)',data:md.map(function(d){return d.medComp}),borderColor:'#ea580c',backgroundColor:'rgba(234,88,12,0.08)',tension:.35,pointRadius:5,pointBackgroundColor:'#ea580c',fill:true,yAxisID:'y'},{label:'Med Response (h)',data:md.map(function(d){return d.medResp}),borderColor:'#0891b2',backgroundColor:'rgba(8,145,178,0.08)',tension:.35,pointRadius:5,pointBackgroundColor:'#0891b2',fill:true,yAxisID:'y'}]},options:Object.assign({},base,{scales:{y:{grid:{color:gridColor},ticks:{color:tickColor,callback:function(v){return v+'h'}}},x:{grid:{display:false},ticks:{color:tickColor}}}})}))}
}

function build(){
  var m=gm(cur),cr=parseFloat(p2(m.completed,m.total)),xr=parseFloat(p2(m.cancelled,m.total));
  var h='<div class="app"><div class="hdr"><div><h1>LAST MILE SERVICE PERFORMANCE</h1><div class="sub">'+(cur==='OVERALL'?'All Stations Rollup':'Station: '+cur)+' &mdash; '+m.total.toLocaleString()+' Work Orders</div></div><div class="stamp">Report Date: 2/23/26</div></div>';
  h+='<div class="tabs"><button class="'+(cur==='OVERALL'?'on':'')+'" data-t="OVERALL">&#9632; Overall</button>';
  names.forEach(function(n){h+='<button class="'+(cur===n?'on':'')+'" data-t="'+n+'">'+n+'</button>'});h+='</div>';

  // KPIs — no financial data
  h+='<div class="kg">';
  h+=kpi('Total Work Orders',m.total.toLocaleString(),'','gr','');
  h+=kpi('Completion Rate',cr+'%',cc(cr),cc(cr),m.completed+' completed');
  h+=kpi('Cancellation Rate',xr+'%',cc(xr,false),cc(xr,false),m.cancelled+' cancelled');
  h+=kpi('Open / In Progress',m.open.toLocaleString(),m.open>10?'ye':'gr',m.open>10?'ye':'gr',m.on_hold+' on hold');
  h+='</div><div class="kg">';
  var tc=m.median_comp_hrs<36?'gr':m.median_comp_hrs<72?'ye':'re';
  h+=kpi('Median Completion',m.median_comp_hrs+'h',tc,tc,'Avg: '+m.avg_comp_hrs+'h');
  var rc=m.median_resp_hrs<12?'gr':m.median_resp_hrs<24?'ye':'re';
  h+=kpi('Median Response',m.median_resp_hrs+'h',rc,rc,m.resp_count+' measured');
  h+=kpi('Completion Count',m.comp_time_count.toLocaleString(),'','cy','with timing data');
  h+=kpi('On Hold',m.on_hold.toLocaleString(),m.on_hold>3?'ye':'gr',m.on_hold>3?'ye':'gr','');
  h+='</div>';

  // MoM
  h+=buildMoMSection(cur);
  // Sentiment
  h+=buildSentimentSection(cur);

  // Status
  h+='<div class="sc perf">Status Distribution</div><div class="bars">';
  topN(m.status_counts,10).forEach(function(e){var w=m.total?(e[1]/m.total*100):0;var c=e[0]==='COMPLETED'?'gr':e[0]==='CANCELLED'?'re':'bl';h+='<div class="br"><div class="bl">'+e[0].replace(/_/g,' ')+'</div><div class="bt"><div class="bf '+c+'" style="width:'+Math.max(w,2)+'%">'+w.toFixed(1)+'%</div></div><div class="bc">'+e[1]+'</div></div>'});h+='</div>';

  h+='<div class="duo"><div><div class="sc det">By Priority</div><div class="tw"><table><thead><tr><th>Priority</th><th>Count</th><th>%</th></tr></thead><tbody>';
  topN(m.priorities,5).forEach(function(e){var pv=p2(e[1],m.total);h+='<tr><td><strong>'+e[0]+'</strong></td><td>'+e[1]+'</td><td><span class="bg '+(parseFloat(pv)>35?'ye':'gr')+'">'+pv+'%</span></td></tr>'});
  h+='</tbody></table></div></div><div><div class="sc det">By Category</div><div class="tw"><table><thead><tr><th>Category</th><th>Count</th><th>%</th></tr></thead><tbody>';
  topN(m.categories,6).forEach(function(e){h+='<tr><td><strong>'+e[0].replace(/_/g,' ')+'</strong></td><td>'+e[1]+'</td><td>'+p2(e[1],m.total)+'%</td></tr>'});h+='</tbody></table></div></div></div>';

  h+='<div class="duo"><div><div class="sc det">Scheduled vs Non-Scheduled</div><div class="tw"><table><thead><tr><th>Type</th><th>Count</th><th>%</th></tr></thead><tbody>';
  topN(m.types,4).forEach(function(e){h+='<tr><td><strong>'+e[0].replace(/_/g,' ')+'</strong></td><td>'+e[1]+'</td><td>'+p2(e[1],m.total)+'%</td></tr>'});
  h+='</tbody></table></div></div><div><div class="sc det">Top Workflows</div><div class="tw"><table><thead><tr><th>Workflow</th><th>Count</th><th>%</th></tr></thead><tbody>';
  topN(m.workflows,8).forEach(function(e){h+='<tr><td><strong>'+e[0].replace(/_/g,' ')+'</strong></td><td>'+e[1]+'</td><td>'+p2(e[1],m.total)+'%</td></tr>'});h+='</tbody></table></div></div></div>';

  // Cancel & Hold
  var cre=topN(m.cancel_reasons,6),hre=topN(m.hold_reasons,6);
  if(cre.length||hre.length){h+='<div class="duo">';if(cre.length){h+='<div><div class="sc perf">Cancellation Reasons</div><div class="tw"><table><thead><tr><th>Reason</th><th>Count</th></tr></thead><tbody>';cre.forEach(function(e){h+='<tr><td>'+e[0].replace(/_/g,' ')+'</td><td><span class="bg re">'+e[1]+'</span></td></tr>'});h+='</tbody></table></div></div>'}if(hre.length){h+='<div><div class="sc perf">Hold Reasons</div><div class="tw"><table><thead><tr><th>Reason</th><th>Count</th></tr></thead><tbody>';hre.forEach(function(e){h+='<tr><td>'+e[0].replace(/_/g,' ')+'</td><td><span class="bg ye">'+e[1]+'</span></td></tr>'});h+='</tbody></table></div></div>'}h+='</div>'}

  // Station comparison — no cost columns
  if(cur==='OVERALL'){
    h+='<div class="sc perf">Station Comparison</div><div class="tw scr"><table><thead><tr><th>Station</th><th>WOs</th><th>Comp %</th><th>Cancel %</th><th>Open</th><th>Med Comp</th><th>Med Resp</th><th>Adoption</th><th>Sentiment</th></tr></thead><tbody>';
    names.forEach(function(sn){var sm=WO.stations[sn],scr2=parseFloat(p2(sm.completed,sm.total)),sxr=parseFloat(p2(sm.cancelled,sm.total));var ad=ADOPTION[sn],adVal=ad?ad.adoption.toFixed(1)+'%':'—',adC=ad?(ad.adoption>=85?'gr':ad.adoption>=70?'ye':'re'):'';var ss=SENTIMENT.filter(function(x){return x.station===sn});var sentVal='—',sentC='';if(ss.length){var tr2=0,ta=0;ss.forEach(function(x){tr2+=x.responses;ta+=x.avg*x.responses});if(tr2){var av=ta/tr2;sentVal=av.toFixed(1)+'/5';sentC=scv(av)}}h+='<tr><td><strong>'+sn+'</strong></td><td>'+sm.total+'</td><td><span class="bg '+cc(scr2)+'">'+scr2+'%</span></td><td><span class="bg '+cc(sxr,false)+'">'+sxr+'%</span></td><td>'+sm.open+'</td><td>'+sm.median_comp_hrs+'h</td><td>'+sm.median_resp_hrs+'h</td><td>'+(adC?'<span class="bg '+adC+'">'+adVal+'</span>':adVal)+'</td><td>'+(sentC?'<span class="bg '+sentC+'">'+sentVal+'</span>':sentVal)+'</td></tr>'});
    h+='</tbody></table></div>';
  }

  h+='</div>';
  document.getElementById('root').innerHTML=h;
  document.querySelectorAll('.tabs button').forEach(function(btn){btn.addEventListener('click',function(){cur=btn.dataset.t;build();window.scrollTo(0,0)})});
  setTimeout(function(){renderCharts(cur)},50);
}
build();
</script>
</body>
</html>
